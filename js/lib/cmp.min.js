function extend(a,b){var c=getClass(a),d=createjs[b]?createjs[b]:getClass(b),e=c.prototype;e.constructorName=b+"_constructor",e._globalName=a,e.construct=function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._dontConstruct)return void(this._dontConstruct=!1);if(a=a||{},b)for(var c=!1,d=this;d&&d.constructorName;){if(c&&b!==d.constructorName)return this.construct(a,d.constructorName),this._dontConstruct=!0,void this[d.constructorName]("Shape_constructor"!==d.constructorName?a:null);c=b===d.constructorName,d=d.__proto__}else this.construct(a,this.constructorName),this._dontConstruct=!0,this[this.constructorName]("Shape_constructor"!==this.constructorName?a:null)};var f=createjs.extend(c,d);return Object.assign(f,e),Object.getPrototypeOf(c.prototype).constructor!==d&&(CMP.Log(CMP.Log.EXTRA,"===Found class "+a+" being extend by "+b+" with mismatching prototype.\n===Adding constructor to allow "+a+" to call this.construct() to construct superclass "+b),Object.getPrototypeOf(c.prototype).constructor=d),c=createjs.promote(c,b),f}function getClass(a){var b=a.split("."),c=window;for(var d in b){if(!c[b[d]])return null;c=c[b[d]]}return c===window?null:c}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},CMP=CMP||{};CMP.PixelRatio=1,CMP.Version="1.0.0",CMP.App=function(){this._updateEvents=[],this.init()},CMP.App.prototype={init:function(){CMP.App=this,this.assetManager=new CMP.AssetManager,this.assetManager.init(this),this.ratio=!!AppConfig&&(!(!AppConfig.width||!AppConfig.height)&&AppConfig.width/AppConfig.height),this.ratio=!(this.ratio||!AppConfig.ratio)&&AppConfig.ratio;var a=CMP.getParameterByName("ratio");a&&(CMP.Log(CMP.Log.NOTICE,"Got ratio from query string:",a),this.ratio=a),this.maxRatio=!!AppConfig&&("number"==typeof AppConfig.maxRatio&&AppConfig.maxRatio),this.canvas=document.getElementById("gcanvas"),this.validateDivs(),this.webGLEnabled=this.webGLAvailable(),this.webGLEnabled=!(!this.webGLEnabled||!0!==AppConfig.USE_STAGEGL),this.webGLEnabled?(console.log("Initialized with WebGL View"),this.stage=new createjs.StageGL(this.canvas,{transparent:AppConfig.TRANSPARENT_WEBGL_STAGE,antialias:!0}),AppConfig.TRANSPARENT_WEBGL_STAGE||(this.stage.setClearColor("#FFFFFF"),this.stage.update())):(console.log("Initialized with Normal View"),this.stage=new createjs.Stage(this.canvas)),this.stage._mOriginalWidth=this.canvas.width,this.stage._mOriginalHeight=this.canvas.height,createjs.Touch.enable(this.stage),createjs.Ticker.framerate=60,createjs.Ticker.addEventListener("tick",this._tickHandler.bind(this)),this._mUpdateSpeed=1,this.stage.enableMouseOver(10),this.stage.mouseMoveOutside=!0;var b=this.stage.update.bind(this.stage);if(b._mScope=this.stage,createjs.Ticker.addEventListener("tick",b),CMP._heatInstance&&CMP._heatInstance.init(),this._onResize=this._onResize.bind(this),CMP.App.stage.addEventListener("resize",CMP.EventSystem.dispatchEvent.bind(CMP.EventSystem)),this.setupInactivity(),"complete"==document.readyState)CMP.Onload.checkPartners();else if("function"==typeof window.onload){var c=window.onload;window.onload=function(){CMP.Onload.checkPartners(),c()}}else window.onload=CMP.Onload.checkPartners();"boolean"==typeof AppConfig.MasterSound&&(CMP.MasterSound=AppConfig.MasterSound),this.setUpRecordingState(),window.addEventListener("message",this.receiveMessage,!1),CMP.Listen("PreviewMute",this.PreviewMute.bind(this)),CMP.Listen("SetHiRes",this.SetHiRes.bind(this))},webGLAvailable:function(){return!!window.WebGLRenderingContext},receiveMessage:function(a){console.log("CMP App receiveMessage",a),void 0!==a.data&&void 0!==a.data.type&&CMP.Dispatch({type:a.data.type,data:a.data.value})},SetHiRes:function(a){var b=a.data;console.log("SetHiRes",b),AppConfig.FORCE_HI_RES=b,CMP.App._onResize(new Event("resize"))},PreviewMute:function(a){var b=a.data;console.log("PreviewMute",b),CMP.App.assetManager.setMasterSound(!b)},updateAudio:function(a,b){if(a&&a.audioController&&a._audio==b&&a.audio&&(CMP.Log(CMP.Log.EXTRA,"updateAudio: replacing audio",b),a.audio=a.audioController.audioElement),a.children&&a.children.length)for(var c=0;c<a.children.length;c++)this.updateAudio(a.children[c],b)},updateVideo:function(a,b){if(a&&a.VCanvas&&a.videoController&&a._video==b&&a.video&&(CMP.Log(CMP.Log.EXTRA,"updateVideo: replacing video",b),a.video=a.VCanvas.video=a.videoController.video),a.children&&a.children.length)for(var c=0;c<a.children.length;c++)this.updateVideo(a.children[c],b)},updateImage:function(a,b){if(a&&a.img&&a.image&&a.image==b&&(CMP.Log(CMP.Log.EXTRA,"updateImage: replacing image",b),a.image=a._image=a.img=!1,a.setImage(b)),a.children&&a.children.length)for(var c=0;c<a.children.length;c++)this.updateImage(a.children[c],b)},validateDivs:function(){if(!this.canvas){var a=document.getElementById("app");if(!a){a=document.createElement("div"),a.id="app";var b=document.getElementById("viewporter");if(!b){b=document.createElement("div"),b.id="viewporter",b.align="center",b.width="100%";var c=document.getElementById("game");c||(c=document.createElement("div"),c.id="game"),c.appendChild(b)}b.appendChild(a)}this.canvas=document.createElement("canvas"),this.canvas.id="gcanvas",a.appendChild(this.canvas)}this.mCanvasDiv=document.getElementById("viewporter");var d=this.mCanvasDiv.getAttribute("style")||"";this.mCanvasDiv.setAttribute("style",d+" z-index: 1; overflow: hidden; -webkit-user-select: none; -ms-touch-action:none; -webkit-tap-highlight-color: transparent; -moz-tap-highlight-color: transparent; -webkit-transform: translateZ(0);"),this.canvas.width=AppConfig.width?AppConfig.width:window.innerWidth,this.canvas.height=AppConfig.height?AppConfig.height:window.innerHeight,document.body.style.padding=document.body.style.margin=0,document.body.style.overflow="hidden"},_onResize:function(a){this.transformAppend="",this.resizedOnce=!0,this._resetInactivity(a),CMP.Log(CMP.Log.EXTRA,a);var b=CMP.Resize.checkPartners(a);AppConfig.LEVEL_CONFIG.ORIENTATION_LOCK="undefined"!=typeof SCENE_CONFIG&&SCENE_CONFIG.length>0?SCENE_CONFIG[0].orientationLock:"None",this.widthToUse=b.w,this.heightToUse=b.h,this.ratio?this._resizeToRatio():this.maxRatio&&this.maxRatio<this.widthToUse/this.heightToUse?(this.ratio=this.maxRatio,this._resizeToRatio(),this.ratio=!1):this._resizeToFit(),a&&this.stage.dispatchEvent(a),window.scrollTo(0,1),this.webGLEnabled&&this.stage.updateViewport(this.canvas.width,this.canvas.height),this.stage.update(),CMP.App.TopCanvas&&CMP.App.TopCanvas.stage.update()},_resizeToRatio:function(){var a=this.widthToUse,b=this.heightToUse;document.getElementById("app").align="center";var c=b*this.ratio>=a?a:b*this.ratio,d=a/this.ratio>=b?b:a/this.ratio;0==c?(0==d&&(c=640*this.ratio,d=640),c=d*this.ratio):0==d&&(d=c/this.ratio),AppConfig.fixedDimensions&&AppConfig.width&&AppConfig.height&&(c=a=AppConfig.width,d=a=AppConfig.height),this.mCanvasDiv.style.width=a+"px",this.mCanvasDiv.style.height=b+"px",this.stage.width=this.canvas.width=c,this.stage.height=this.canvas.height=d},_resizeToFit:function(){this.stage&&(AppConfig.PLATFORM_RES?this.setToPixelRatio(this.widthToUse,this.heightToUse):(this._setStageCanvas(this.widthToUse,this.heightToUse,1),this._checkForceHiRes(),this._checkHiResOffset(),this._checkFixedDimensions()))},setToPixelRatio:function(a,b){var c=this.canvas.getContext("2d"),d=window.devicePixelRatio||1,e=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1,f=CMP.PixelRatio=d/e;this.stage.width=this.canvas.width=a*f,this.stage.height=this.canvas.height=b*f,this.canvas.style.width=a+"px",this.canvas.style.height=b+"px",c.setTransform(f,0,0,f,0,0)},_checkForceHiRes:function(){(this.widthToUse<300&&this.heightToUse<300||AppConfig.FORCE_HI_RES)&&this._setStageCanvas(this.widthToUse,this.heightToUse,2)},_checkHiResOffset:function(){if((this.widthToUse>1e3||this.heightToUse>1e3)&&"number"==typeof AppConfig.HIGH_RES_OFFSET){var a=this.widthToUse>this.heightToUse?this.widthToUse:this.heightToUse,b=1e3*AppConfig.HIGH_RES_OFFSET/a;this._setStageCanvas(this.widthToUse,this.heightToUse,b)}},_checkFixedDimensions:function(){AppConfig.fixedDimensions&&AppConfig.width&&AppConfig.height&&(this.widthToUse=this.stage.width=this.canvas.width=AppConfig.width,this.heightToUse=this.stage.height=this.canvas.height=AppConfig.height)},_setStageCanvas:function(a,b,c){this.stage.width=this.canvas.width=a*c,this.stage.height=this.canvas.height=b*c,this.mCanvasDiv.style.width=this.widthToUse*c+"px",this.mCanvasDiv.style.height=this.heightToUse*c+"px",document.getElementById("viewporter").style.transform=this.transformAppend+"scale("+1/c+")",document.getElementById("viewporter").style.transformOrigin="top left"},addUpdate:function(a){return this._updateEvents.push(a),a},setGameSpeed:function(a){if("number"!=typeof a&&a<0)return!1;this._mUpdateSpeed=a},_tickHandler:function(a){if(CMP.MasterUpdate&&0!=this._mUpdateSpeed){"number"==typeof this._mUpdateSpeed&&(a.delta*=this._mUpdateSpeed);for(var b=this._updateEvents.length-1;b>=0;b--){var c=this._updateEvents[b];c._mScope&&c._mScope._markedForRemoval?this._updateEvents.splice(b,1):c._mScope&&c._mScope._ignoreUpdate||c(a)}}},_removeEvent:function(a,b){switch(a){case"update":this.removeIfIn(this._updateEvents,b)}},removeIfIn:function(a,b){for(var c=a.length-1;c>=0;c--)a[c]===b&&a.splice(c,1)},removeUpdate:function(a){this._removeEvent("update",a)},applyTemplates:function(a){a.tweenTo=CMP.App.tweenTemplate.bind(a),a.clearTweens=CMP.App._clearTweensTemplate.bind(a),a.resetTweens=CMP.App._clearTweensTemplate.bind(a),a._offsetRegX="number"==typeof a._offsetRegX?a._offsetRegX:0,a._offsetRegY="number"==typeof a._offsetRegY?a._offsetRegY:0,a.addUpdate=CMP.App._addUpdateTemplate.bind(a),a.removeUpdate=CMP.App._removeUpdateTemplate.bind(a),a.performAction=CMP.App._performTemplate.bind(a),a.toggleUpdate=CMP.App._toggleUpdateTemplate.bind(a),a.setInterval=CMP.App._intervalTemplate.bind(a),a.percentageOfWidth=CMP.App._percentageWidthTemplate.bind(a),a.percentageOfHeight=CMP.App._percentageHeightTemplate.bind(a),a.bringToFront=CMP.App._bringToFront.bind(a),a.sendToBack=CMP.App._sendToBack.bind(a),a.shake=CMP.App._shakeTemplate.bind(a),this._applyListenTemplate(a)},_applyListenTemplate:function(a){a.addListenSet=a.addListen=CMP.App._addListenTemplate.bind(a),a.removeListenSet=a.removeListen=CMP.App._removeListenTemplate.bind(a),a._initListeners=CMP.App._initListenersTemplate.bind(a),a._resizeListener=a._resize=CMP.App.resizeTemplate.bind(a),a.addListen("resize",a._resize),a._initListeners()},_initListenersTemplate:function(){for(var a=0;a<this.listensTo.length;a++)this.addListen(this.listensTo[a])},_sendToBack:function(){if(this.parent&&this.parent.children)for(var a=this,b=0;b<this.parent.children.length;b++){if(this.parent.children[b]===this)return void(this.parent.children[b]=a);var c=this.parent.children[b];this.parent.children[b]=a,a=c}},_bringToFront:function(){if(this.parent&&this.parent.children){var a=this.parent.children.indexOf(this);a>=0&&this.parent.children.splice(a,1),this.parent.children.push(this)}},_clearTweensTemplate:function(){if(this._activeTweens)for(var a=0;a<this._activeTweens.length;a++)this._activeTweens[a].endEarly()},_percentageWidthTemplate:function(a){return("number"==typeof this.width?this.width:0)*a},_percentageHeightTemplate:function(a){return("number"==typeof this.height?this.height:0)*a},_intervalTemplate:function(a,b){return CMP.Interval(a,b,this)},_toggleUpdateTemplate:function(a){if(this._ignoreUpdate=!a,this.children&&this.children.length)for(var b=0;b<this.children.length;b++)"function"==typeof this.children[b].toggleUpdate&&this.children[b].toggleUpdate(a)},_addUpdateTemplate:function(a){return a._mScope||(a._mScope=this),CMP.App.addUpdate(a)},_removeUpdateTemplate:function(){for(var a=CMP.App._updateEvents.length-1;a>=0;a--){CMP.App._updateEvents[a]._mScope===this&&CMP.App._updateEvents.splice(a,1)}},_addListenTemplate:function(a,b){if(void 0===b){if("function"!=typeof this[a])return void CMP.Log(CMP.Log.EXTRA,"Object listensTo for"+a,"with no function of the same name.");b=this[a].bind(this)}return b._eventCaller=this,b._eventType=a,CMP.Listen(a,b),this._cleanupEventTypes||(this._cleanupEventTypes=[]),-1==this._cleanupEventTypes.indexOf(a)&&this._cleanupEventTypes.push(a),this.removeListen.bind(this,a,b)},_removeListenTemplate:function(a,b){CMP.RemoveListen(a,b,this)},_performTemplate:function(a){return a.scope||(a.scope=this),CMP.PerformAction(a)},_shakeTemplate:function(a){return a||(a={}),a.scope||(a.scope=this),"number"!=typeof a.shakeTimes&&(a.shakeTimes=2),"number"!=typeof a.yMagnitude&&(a.yMagnitude=20),"number"!=typeof a.xMagnitude&&(a.xMagnitude=20),a.magnitude&&(a.xMagnitude=a.magnitude,a.yMagnitude=a.magnitude),a.randomizeMagnitude&&(a.xMagnitude=Math.random()*(1.5*a.xMagnitude-.5*a.xMagnitude)+.5*a.xMagnitude,a.yMagnitude=Math.random()*(1.5*a.yMagnitude-.5*a.yMagnitude)+.5*a.yMagnitude),a.easing||(a.easing=CMP.Tween.Elastic.InOut),a.endEasing||(a.endEasing=a.easing),a.duration||(a.duration=.02),a.endDuration||(a.endDuration=a.duration),a.origLayout=Object.assign({},a.scope.layout),a.origX=a.scope.x,a.origY=a.scope.y,a.scope||(a.scope=this),new CMP.Shaker(a)},resizeTemplate:function(){if(this._markedForRemoval)return void this.removeListen("resize");if(this.parent){var a=this.layout;if("function"==typeof a&&(a=this.layout(this.parent.width/this.parent.height)),"string"==typeof a){var b=this.parent.width/this.width,c=this.parent.height/this.height;"match"===a?(this.scaleX=this.scaleY="number"==typeof this._matchScale?this._matchScale:1,this.x=this.parent.width*this.registrationX-(this.parent.regX?this.parent.regX:0)+this.parent.width*(1-this.scaleX)/2,this.y=this.parent.height*this.registrationY-(this.parent.regY?this.parent.regY:0)+this.parent.height*(1-this.scaleY)/2,this._forceZero&&(this.x=this.y=0),this.width=this.parent.width,this.height=this.parent.height):"fill"===a?(this.registrationX=this.registrationY=this.regX=this.regY=this.x=this.y=0,this.regX+=this._offsetRegX,this.regY+=this._offsetRegY,this.scaleX=b,this.scaleY=c):"overfill"===a?(this.registrationX=this.registrationY=this.regX=this.regY=this.x=this.y=0,this.overfillX="number"==typeof this.overfillX?this.overfillX:1,this.overfillY="number"==typeof this.overfillY?this.overfillY:1,this.regX+=this._offsetRegX,this.regY+=this._offsetRegY,this.scaleX=b*this.overfillX,this.scaleY=c*this.overfillY):"aspect-fill"===a?(this.x=this.parent.width*this.registrationX,this.y=this.parent.height*this.registrationY,this.scaleX=this.scaleY=Math.max(b,c)):"fit-width"===a||"best-fit"===a&&b<=c?(this.x=this.parent.width*this.registrationX,this.y=(this.parent.height-this.height*b)/2+this.regX*this.height*b,this.scaleX=this.scaleY=b,this.scale=b):("fit-height"===a||"best-fit"===a&&c<b)&&(this.x=(this.parent.width-this.width*c)/2+this.registrationX*this.width*c,this.y=this.parent.height*this.registrationY,this.scaleX=this.scaleY=c)}else if("object"===(void 0===a?"undefined":_typeof(a))){var d=this.width,e=this.height;a.rotate90&&(d=this.height,e=this.width),"number"==typeof a.xPercentage&&(this.registrationX=.5,this.x=this.parent.width*a.xPercentage),"number"==typeof a.yPercentage&&(this.registrationY=.5,this.y=this.parent.height*a.yPercentage),"number"==typeof a.anchorTop&&(this.registrationY=0,this.y=a.anchorTop*this.parent.height),"number"==typeof a.anchorBottom&&(this.registrationY=1,this.y=this.parent.height-a.anchorBottom*this.parent.height),"number"==typeof a.anchorLeft&&(this.registrationX=0,this.x=a.anchorLeft*this.parent.width),"number"==typeof a.anchorRight&&(this.registrationX=1,this.x=this.parent.width-a.anchorRight*this.parent.width),this.regX=this.width*this.registrationX+this._offsetRegX,this.regY=this.height*this.registrationY+this._offsetRegY,"object"===_typeof(a.dockTo)&&(a.dockTo._resize(a.dockTo.strategy,event),this.x=a.dockTo.x+("number"==typeof a.dockOffsetX?a.dockOffsetX*a.dockTo.scaleX:0),this.y=a.dockTo.y+("number"==typeof a.dockOffsetY?a.dockOffsetY*a.dockTo.scaleY:0)),!0!==a.allowSubPixel&&(this.x=Math.round(this.x),this.y=Math.round(this.y));var b,c;b=c=!1===a.useMinScale?-Number.MAX_VALUE:Number.MAX_VALUE,"number"==typeof a.scaleToWidth&&(b=this.parent.width/d*a.scaleToWidth),"number"==typeof a.scaleToHeight&&(c=this.parent.height/e*a.scaleToHeight),this.scaleX=this.scaleY=!1===a.useMinScale?Math.max(b,c):Math.min(b,c),"number"==typeof a.xFillPercentage&&(this.scaleX=this.parent.width/d*a.xFillPercentage),"number"==typeof a.yFillPercentage&&(this.scaleY=this.parent.height/e*a.yFillPercentage)}if(this.resize(),this.children&&this.children.length)for(var f=0;f<this.children.length;f++)"function"==typeof this.children[f]._resize&&this.children[f]._resize()}},setupInactivity:function(){CMP.Log(CMP.Log.NOTICE,"in setupInactivity"),this._inactivityEvents=[],this._activityEvents=[],this.stage.addEventListener("stagemousedown",this._resetInactivity.bind(this)),this.stage.addEventListener("stagemouseup",this._resetInactivity.bind(this)),this.stage.addEventListener("stagemousemove",this._resetInactivity.bind(this)),this.addUpdate(this._trackInactivity.bind(this)),this._inactivityTimer=-1},removeInactive:function(a){for(var b=this._inactivityEvents.length-1;b>=0;b--)this._inactivityEvents[b]==a&&this._inactivityEvents.splice(b,1)},removeActivity:function(a){for(var b=this._activityEvents.length-1;b>=0;b--)this._activityEvents[b]==a&&this._activityEvents.splice(b,1)},onActivity:function(a,b){if("function"!=typeof a)return void CMP.Log(CMP.Log.ERROR,"Invalid function passed to onActivity");var c={callback:a,once:b};return c.remove=this.removeActivity.bind(this,c),this._activityEvents.push(c),c},onInactive:function(a,b,c){if("function"!=typeof a)return void CMP.Log(CMP.Log.ERROR,"Invalid function passed to onInactive");if("number"!=typeof b)return void CMP.Log(CMP.Log.ERROR,"Invalid timeout passed to onInactive");var d={callback:a,timeout:1e3*b,once:c};return d.remove=this.removeInactive.bind(this,d),this._inactivityEvents.push(d),d},onViewableChange:function(a,b){if(this.viewableChangeEvents||(this.viewableChangeEvents=[]),"function"!=typeof a)return void CMP.Log(CMP.Log.ERROR,"Invalid function passed to onViewableChange");var c={callback:a,once:b};return c.remove=this.removeViewableChange.bind(this,c),this.viewableChangeEvents.push(c),c},removeViewableChange:function(a){this.viewableChangeEvents||(this.viewableChangeEvents=[]);for(var b=this.viewableChangeEvents.length-1;b>=0;b--)this.viewableChangeEvents[b]==a&&this.viewableChangeEvents.splice(b,1)},fireViewableChange:function(a){this.viewableChangeEvents||(this.viewableChangeEvents=[]);for(var b=this.viewableChangeEvents.length-1;b>=0;b--){var c=this.viewableChangeEvents[b];c.callback(a),c.once&&c.remove()}},_trackActivity:function(a){for(var b=this._activityEvents.length-1;b>=0;b--){var c=this._activityEvents[b];c.callback(),c.once&&c.remove()}},_trackInactivity:function(a){var b=a.delta;if(!(this._inactivityTimer<0)){this._inactivityTimer+=b;for(var c=this._inactivityEvents.length-1;c>=0;c--){var d=this._inactivityEvents[c],e=(this._inactivityTimer-b)%d.timeout,f=this._inactivityTimer%d.timeout;if(this._inactivityTimer>d.timeout&&e>f){var g=d.callback(a);d.once&&!g&&d.remove()}}}},_resetInactivity:function(a){!CMP.FIRST_TAP&&a&&"stagemousedown"==a.type&&(CMP.FIRST_TAP=!0,this._trackActivity(a)),this._inactivityTimer=0,window.focus()},tweenTemplate:function(a){this._activeTweens||(this._activeTweens=[]);var b=new CMP.Tween(a,this);return this._activeTweens.push(b),this._tweenListener||(this._tweenListener=CMP.App._tweenListener.bind(this),this._tweenListener._mScope=this,CMP.App.addUpdate(this._tweenListener)),b},_tweenListener:function(a){if(this._markedForRemoval)return void CMP.App.removeUpdate(this._tweenListener);for(var b=a.delta,c=this._activeTweens.length-1;c>=0;c--){var d=this._activeTweens[c];d.advance(b/1e3),d.finished&&this._activeTweens.splice(c,1)}},setUpRecordingState:function(){this.recordingStateCursorRadius=20,"true"==CMP.getParameterByName("recordingState")&&(CMP.App.stage.addEventListener("stagemousemove",this.activateCursor.bind(this)),CMP.App.stage.addEventListener("stagemousedown",this.activateCursor.bind(this)),CMP.App.stage.addEventListener("stagemouseup",this.removeCursor.bind(this)),CMP.App.onInactive(this.removeCursor.bind(this),.5))},activateCursor:function(a){this.cursorCircle?(this.cursorCircle.x=a.stageX,this.cursorCircle.y=a.stageY,this.innercursorCircle.x=a.stageX,this.innercursorCircle.y=a.stageY):(this.cursorCircle=this.stage.addChild(new CMP.Circle({radius:this.recordingStateCursorRadius,backgroundColor:"black",x:a.stageX,y:a.stageY,alpha:0})),this.cursorCircle.tweenTo({alpha:.6,duration:.5,rewind:!0,loop:!0}),this.innercursorCircle=this.stage.addChild(new CMP.Circle({radius:13,backgroundColor:"black",x:a.stageX,y:a.stageY,alpha:0})),this.innercursorCircle.tweenTo({alpha:.8,duration:.3}))},removeCursor:function(){var a=this;this.cursorCircle&&(this.cursorCircle.clearTweens(),this.cursorCircle.tweenTo({alpha:0,duration:.3,onComplete:function(){a.cursorCircle.markForRemoval(),a.cursorCircle=void 0}}),this.innercursorCircle.clearTweens(),this.innercursorCircle.tweenTo({alpha:0,duration:.3,onComplete:function(){a.innercursorCircle.markForRemoval(),a.innercursorCircle=void 0}}))}},CMP.EventSystem={_eventTypes:[],addListen:function(a,b){this._eventTypes[a]||(this._eventTypes[a]=[]),this._eventTypes[a].push(b)},removeListen:function(a,b,c){var d=this._eventTypes[a];if(d)for(var e=d.length-1;e>=0;e--)(d[e]===b||void 0===b&&void 0!==c&&d[e]._eventCaller===c)&&d.splice(e,1);else CMP.Log(CMP.Log.WARNING,"Tried to remove listen for undefined event type (",a,").")},removeCaller:function(a){var b=a.caller;if(b)for(var c in this._eventTypes)for(var d=this._eventTypes[c],e=d.length-1;e>=0;e--)d[e]&&d[e]._eventCaller===b&&d.splice(e,1)},dispatchEvent:function(a){var b=a.type,c=this._eventTypes[b],d=void 0;if(c)for(var e=0;e<c.length;e++)d=c[e](a);else CMP.Log(CMP.Log.ALL,"Dispatched event type with no listeners(",b,").");return d}},CMP.RemoveListen=function(a,b,c){CMP.EventSystem.removeListen(a,b,c)},CMP.Listen=function(a,b){return b._eventType=a,CMP.EventSystem.addListen(a,b),function(){CMP.EventSystem.removeListen(a,b)}},CMP.ListenSet=function(a,b){return CMP.Listen(a,b)},CMP.Dispatch=function(a){if(void 0!==a){if("string"==typeof a&&(a={type:a}),a._recurTree)for(var b=CMP._DispatchRecursion(CMP.App.stage,a),c=0;c<b.length;c++)b[c](a);return CMP.EventSystem.dispatchEvent(a)}},CMP._DispatchRecursion=function(a,b){if(!a)return[];var c=[];if(void 0!==a.children)for(var d=0;d<a.children.length;d++){var e=a.children[d];if(void 0!==e&&e&&void 0!==e._listeners&&e._listeners&&void 0!==e._listeners[b.type]&&e._listeners[b.type])for(var f=0;f<e._listeners[b.type].length;f++)c.push(e._listeners[b.type][f]);var g=CMP._DispatchRecursion(e,b);c=c.concat(g)}return c},CMP.DispatchGet=function(a){return CMP.Dispatch(a)},CMP.ReplaceImage=function(a,b,c){CMP.App.assetManager.updateImage({id:a,src:b,callback:c})},CMP.ReplaceVideo=function(a,b,c){CMP.App.assetManager.updateVideo({id:a,src:b,callback:c})},CMP.ReplaceAudio=function(a,b,c){CMP.App.assetManager.updateAudio({id:a,src:b,callback:c})},CMP.ReplaceFont=function(a,b,c){CMP.App.assetManager.updateFont({id:a,src:b,callback:c})},CMP.DisableImage=function(a,b){CMP.App.assetManager.disableImage({id:a,callback:b})},CMP.EnableImage=function(a,b){CMP.App.assetManager.enableImage({id:a,callback:b})},CMP.PauseVideos=function(){CMP.App.assetManager.pauseVideos(CMP.App.assetManager.videoFiles)},CMP.BLANK="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wUNDy4dBdO26QAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAALSURBVAjXY2AAAgAABQAB4iYFmwAAAABJRU5ErkJggg==",CMP.AssetManager=function(){this.images=[],this.audioFiles=[],this.fonts=[],this.videoFiles=[]},CMP.AssetManager.prototype={init:function(a){a.addAsset=this.addAsset.bind(this),a.getAsset=this.getAsset.bind(this),a.getImage=this.getImage.bind(this),a.getAudio=this.getAudio.bind(this),a.getVideo=this.getVideo.bind(this),a.getFont=this.getFont.bind(this)},pauseVideos:function(a){CMP.Log(CMP.Log.NOTICE,"videos",a)},updateAudio:function(a){if(a&&a.src)if(this.audioFiles[a.id]){for(var b=0;b<this.audioFiles[a.id].length;b++){var c=Object.assign({},a);c.thisI=b;var d=this.audioFiles[a.id][b],e=!1;d.playing&&(e=!0,d.audioElement.pause()),c.audioLoaders=this.audioFiles[a.id],d.config=c,CMP.Log(CMP.Log.ALL,"Loading audio",c.id);var f=d.createElement();d.addEventListener("loadeddata",this.audioReplace.bind(this,c),!0),d.addEventListener("error",this.replacementFailed.bind(this,c),!0),c.audio=f,setTimeout(this.loadTimeout.bind(this,c),3e4),f.src=c.src,d.url=c.src,e&&d.audioElement.play()}this.configCallback(a)}else CMP.Log(CMP.Log.ERROR,"Audio does not exist",a)},updateVideo:function(a){if(a&&a.src)if(this.videoFiles[a.id]){for(var b=0;b<this.videoFiles[a.id].length;b++){var c=Object.assign({},a);c.thisI=b;var d=this.videoFiles[a.id][b];c.videoLoaders=this.videoFiles[a.id],d.config=c,CMP.Log(CMP.Log.ALL,"Loading video",c.id);var e=d._createElement();d.addEventListener("loadeddata",this.videoReplace.bind(this,c),!0),d.addEventListener("error",this.replacementFailed.bind(this,c),!0),c.vid=e,setTimeout(this.loadTimeout.bind(this,c),3e4),e.src=c.src}this.configCallback(a)}else CMP.Log(CMP.Log.ERROR,"Video does not exist",a)},updateFont:function(a){if(a&&a.src){var b=document.getElementsByTagName("style");if(b.length>1)for(var c=b.length-1;c>=1;c--)b[c]&&b[c].parentNode&&b[c].parentNode.removeChild(b[c]);var d=new CMP.Font;d.fontFamily=a.id,d.src=a.src,void 0!==this.fonts[a.id]&&(this.fonts[a.id].font=d),d.onload=function(){this.configCallback(a)}.bind(this),CMP.Log(CMP.Log.NOTICE,"loaded new font",d)}},updateImage:function(a){CMP.Log(CMP.Log.ALL,"Loading image from",a.src);var b=new Image;a.img=b,b.onload=this.replacementLoader.bind(this,a),b.onerror=this.replacementFailed.bind(this,a),setTimeout(this.loadTimeout.bind(this,a),3e4),b.src=a.src},disableImage:function(a){var b=this.images[a.id];if(b){var c=b.img;if(c._isDisabled)return;var d=new Image;a.img=d,d.onload=this.replacementLoader.bind(this,a),d.onerror=this.replacementFailed.bind(this,a),setTimeout(this.loadTimeout.bind(this,a),3e4),d._isDisabled=!0,d.disabledSrc=c.src,d.src=CMP.BLANK}else CMP.Log(CMP.Log.ERROR,"Image does not exist",a)},enableImage:function(a){var b=this.images[a.id];if(b){var c=b.img;if(!c._isDisabled)return;var d=new Image;a.img=d,d.onload=this.replacementLoader.bind(this,a),d.onerror=this.replacementFailed.bind(this,a),setTimeout(this.loadTimeout.bind(this,a),3e4),d.src=c.disabledSrc,d.disabledSrc=d._isDisabled=!1}else CMP.Log(CMP.Log.ERROR,"Image does not exist",a)},audioReplace:function(a){if(a&&a.src){var b=this.audioFiles[a.id][a.thisI];if(b){if("number"==typeof b.delayCount&&b.delayCount>0)return;b.delayCount=1e3,CMP.App.addUpdate(function(a){var c=a.delta;b.delayCount-=c}.bind(this)),CMP.Log(CMP.Log.ALL,"Replacing audio at pos",a),b.src=a.audio.src,b.audioElement=a.audio,a.loaded=!0,CMP.App.updateAudio(CMP.App.stage,a.id),this.configCallback(a)}else CMP.Log(CMP.Log.ERROR,"Audio does not exist",a)}},videoReplace:function(a){if(a&&a.src){var b=this.videoFiles[a.id][a.thisI];if(b){if("number"==typeof b.delayCount&&b.delayCount>0)return;b.delayCount=1e3,CMP.App.addUpdate(function(a){var c=a.delta;b.delayCount-=c}.bind(this)),CMP.Log(CMP.Log.ALL,"Replacing video at pos",a.thisI,a.id),b.src=a.vid.src,b.vid=a.vid,a.loaded=!0,CMP.App.updateVideo(CMP.App.stage,a.id),this.configCallback(a)}else CMP.Log(CMP.Log.ERROR,"Video does not exist",a)}},replacementLoader:function(a){if(a&&a.src)if(this.images[a.id]){if("number"==typeof this.images[a.id].delayCount&&this.images[a.id].delayCount>0)return;this.images[a.id].delayCount=1e3,CMP.App.addUpdate(function(b){var c=b.delta;this.images[a.id].delayCount-=c}.bind(this)),CMP.Log(CMP.Log.ALL,"Replacing image",a.id),this.images[a.id].src=a.img.src,this.images[a.id].img=a.img,a.loaded=!0,CMP.Dispatch({type:"ImageReplaced",data:{id:a.id,image:this.images[a.id]}}),CMP.App.updateImage(CMP.App.stage,a.id),this.configCallback(a)}else CMP.Log(CMP.Log.ERROR,"Image does not exist",a)},replacementFailed:function(a){CMP.Log(CMP.Log.ERROR,"Asset replacement failed",a),this.configCallback(a)},loadTimeout:function(a){if(!a.loaded){try{CMP.Log(CMP.Log.ERROR,"Failed to load in time",JSON.stringify(a))}catch(a){CMP.Log(CMP.Log.ERROR,"Failed to load in time")}void 0!==CMP._sceneManager&&!1===CMP._sceneManager.live||this.configCallback(a)}},configCallback:function(a){void 0===a||"function"!=typeof a.callback||a.callback.called?CMP.Log(CMP.Log.ERROR,"Skipping callback function"):(a.callback(),a.callback.called=!0)},addAsset:function(a,b){switch(a){case"Image":this.images[b.id]?CMP.Log(CMP.Log.WARNING,"Image with that id (",b.id,") already exists"):this.images[b.id]=b;break;case"Audio":this.audioFiles[b.id]?CMP.Log(CMP.Log.WARNING,"Audio with that id (",b.id,") already exists"):this.audioFiles[b.id]=b.audioLoaders;break;case"Video":this.videoFiles[b.id]?CMP.Log(CMP.Log.WARNING,"Video with that id (",b.id,") already exists"):this.videoFiles[b.id]=b.videoLoaders;break;case"Font":this.fonts[b.id]?CMP.Log(CMP.Log.WARNING,"Font with that id (",b.id,") already exists"):(CMP.Log(CMP.Log.NOTICE,"CMP: new font",b),this.fonts[b.id]=b)}},getImage:function(a,b){return this.getAsset("Image",a,b)},getAudio:function(a,b){return this.getAsset("Audio",a,b)},getVideo:function(a,b){return this.getAsset("Video",a,b)},getFont:function(a,b){return this.getAsset("Font",a,b)},getAssetSize:function(a,b){var c=this.getAsset(b,a);return c&&c.font&&c.font.newFontData.includes("data:")?.75*c.font.newFontData.split("base64,")[1].length:c&&c.src&&c.src.includes("data:")?.75*c.src.split("base64,")[1].length:c&&c.video&&c.video&&c.video.src.includes("data:")?.75*c.video.src.split("base64,")[1].length:c&&c.audioElement&&c.audioElement.src.includes("data:")?.75*c.audioElement.src.split("base64,")[1].length:void 0},getAssetHeight:function(a){if(void 0!==this.images){var b=this.images[a];if(void 0!==b)return b.dimensions.height}},getUniqueVid:function(a,b,c){if(void 0===b&&CMP.App.getVideo(a,c),this.videoFiles[a]){for(var d=this.videoFiles[a][0],e=0;e<this.videoFiles[a].length;e++)this.videoFiles[a][e].uniqueID===b&&(d=this.videoFiles[a][e]);if(!d.error)return d.calledOnComplete||c||CMP.Log(CMP.Log.ERROR,"Tried to play a video that didn't load",d.uniqueID," Passing controller obj"),d;c||CMP.Log(CMP.Log.ERROR,"Tried to play a video that had an error load",a)}else c||CMP.Log(CMP.Log.ERROR,"Failed to find video with id:'"+a+"'")},getAsset:function(a,b,c){switch(a){case"Image":if(this.images[b]){if(!this.images[b].error)return this.images[b].loaded||c||CMP.Log(CMP.Log.ERROR,"Error: Tried to draw image that didn't load",b," Passing img obj"),this.images[b].img;c||CMP.Log(CMP.Log.ERROR,"Error: Tried to draw image that had an error loading",b)}else c||CMP.Log(CMP.Log.ERROR,"Failed to find image with id:'"+b+"'");return;case"Audio":if(this.audioFiles[b]){var d=this.audioFiles[b].shift();if(this.audioFiles[b].push(d),!d.error)return d.calledOnComplete||c||CMP.Log(CMP.Log.ERROR,"Tried to play an audio that didn't load",b," Passing controller obj"),d;c||CMP.Log(CMP.Log.ERROR,"Tried to play an audio that had an error load",b)}else c||CMP.Log(CMP.Log.ERROR,"Failed to find audio with id:'"+b+"'");return;case"Video":if(this.videoFiles[b]){var d=this.videoFiles[b].shift();if(this.videoFiles[b].push(d),!d.error)return d.calledOnComplete||c||CMP.Log(CMP.Log.ERROR,"Tried to play a video that didn't load",d.uniqueID," Passing controller obj"),d;c||CMP.Log(CMP.Log.ERROR,"Tried to play a video that had an error load",b)}else c||CMP.Log(CMP.Log.ERROR,"Failed to find video with id:'"+b+"'");return;case"Font":if(this.fonts[b]){if(!this.fonts[b].error)return this.fonts[b].font.loaded||c||CMP.Log(CMP.Log.ERROR,"Error: Tried to use font that didn't load",b," Passing font obj"),this.fonts[b];c||CMP.Log(CMP.Log.ERROR,"Error: Tried to use font that had an error loading",b)}else c||CMP.Log(CMP.Log.ERROR,"Failed to find font with id:'"+b+"'");return}},isVideoReady:function(){for(var a in this.videoFiles)for(var b=this.videoFiles[a],c=0;c<b.length;c++)if((!b[c].loadeddata||b[c].pauseNextFrame)&&!b[c].loadError)return!1;return!0},pauseAll:function(){for(var a in this.audioFiles)for(var b in this.audioFiles[a])this.audioFiles[a][b].playing&&(this.audioFiles[a][b].wasPlaying=!0,this.audioFiles[a][b].pauseAudio())},resumeAll:function(){for(var a in this.audioFiles)for(var b in this.audioFiles[a])this.audioFiles[a][b].wasPlaying&&(this.audioFiles[a][b].wasPlaying=!1,this.audioFiles[a][b].playAudio())},muteAll:function(){for(var a in this.audioFiles)for(var b in this.audioFiles[a])this.audioFiles[a][b].toggleMute(!0)},unmuteAll:function(){for(var a in this.audioFiles)for(var b in this.audioFiles[a])this.audioFiles[a][b].toggleMute(!1)},setMasterSound:function(a){CMP.MasterSound=!1!==typeof AppConfig.MasterSound&&a;for(var b in this.audioFiles)for(var c in this.audioFiles[b])this.audioFiles[b][c].updateMuted();for(var d in this.videoFiles)for(var e in this.videoFiles[d])this.videoFiles[d][e].updateMuted()}},CMP.MasterSound=!0,CMP.CreateLoadingOverlay=function(){CMP._loadingOverlay||(CMP._loadingOverlay=new CMP.Overlay,CMP.MasterUpdate=!1)},CMP.RemoveLoadingOverlay=function(){CMP._loadingOverlay&&(CMP._loadingOverlay.markForRemoval(),CMP._loadingOverlay=null,CMP.MasterUpdate=!0)},CMP.SetSkip=function(a){CMP.App._skipFunction=a,CMP.App._skipOnStart&&a()},CMP.SkipAd=function(){CMP.App&&"function"==typeof CMP.App._skipFunction?CMP.App._skipFunction():CMP.App._skipOnStart=!0},CMP.MasterUpdate=!0,CMP.Interval=function(a,b,c){return new CMP.Action({scope:c,action:a,delay:b,repeat:!0})},CMP.Shake=function(a){return new CMP.App._shakeTemplate(a)},CMP.Shaker=function(a){this.settings=a,CMP.assign(this,a);this.scope.layout;return this.currentShakeTimes=this.settings.shakeTimes,this.currentLoop=this.settings.loop,this.shakeTween(),this},CMP.Shaker.prototype={shakeTween:function(){var a={};if(this.currentLoop&&(this.settings.shakeTimes=1,this.currentShakeTimes=1),this.currentShakeTimes>0){this.currentShakeTimes--;var b=Math.round(Math.random()),c=this.settings.yMagnitude;0==b&&(c=-this.settings.yMagnitude);var d=Math.round(Math.random()),e=this.settings.xMagnitude;0==d&&(e=-this.settings.xMagnitude),a.easing=this.settings.easing,a.duration=this.settings.duration,a.onComplete=this.shakeTween.bind(this);var f=this.scope.layout;if("object"==(void 0===f?"undefined":_typeof(f))){this.layoutToChange={},"number"==typeof f.yPercentage&&(this.layoutToChange.yType="yPercentage",this.layoutToChange.y=f.yPercentage),"number"==typeof f.anchorBottom&&(this.layoutToChange.yType="anchorBottom",this.layoutToChange.y=f.anchorBottom),"number"==typeof f.anchorTop&&(this.layoutToChange.yType="anchorTop",this.layoutToChange.y=f.anchorTop),"number"==typeof f.anchorLeft&&(this.layoutToChange.xType="anchorLeft",this.layoutToChange.x=f.anchorLeft),"number"==typeof f.anchorRight&&(this.layoutToChange.xType="anchorRight",this.layoutToChange.x=f.anchorRight),"number"==typeof f.xPercentage&&(this.layoutToChange.xType="xPercentage",this.layoutToChange.x=f.xPercentage),"number"==typeof f.scaleToWidth&&(this.layoutToChange.xScaleType="scaleToWidth",this.layoutToChange.xScale=f.scaleToWidth),"number"==typeof f.xFillPercentage&&(this.layoutToChange.xScaleType="xFillPercentage",this.layoutToChange.xScale=f.xFillPercentage),"number"==typeof f.scaleToHeight&&(this.layoutToChange.yScaleType="scaleToHeight",this.layoutToChange.yScale=f.scaleToHeight),"number"==typeof f.yFillPercentage&&(this.layoutToChange.yScaleType="yFillPercentage",this.layoutToChange.yScale=f.yFillPercentage);var g={};g[this.layoutToChange.xType]=this.settings.origLayout[this.layoutToChange.xType]+Math.random()*e/1e3,g[this.layoutToChange.yType]=this.settings.origLayout[this.layoutToChange.yType]+Math.random()*c/1e3,a.layout=g}else a.x=this.settings.origX+Math.random()*e,a.y=this.settings.origY+Math.random()*c}else a.easing=this.settings.endEasing,a.duration=this.settings.endDuration,a.onComplete=this.settings.onComplete,"object"==(void 0===f?"undefined":_typeof(f))?a.layout=this.settings.origLayout:(a.x=this.settings.origX,a.y=this.settings.origY);this.settings.scope.tweenTo(a)},stop:function(){this.currentShakeTimes=0,this.currentLoop=!1}},CMP.PerformAction=function(a){return new CMP.Action(a)},CMP.Action=function(a){if("function"!=typeof a.action)return void CMP.Log(CMP.Log.ERROR,"Action created without a proper function assigned");this.callback=a.action,this.repeat=void 0!==a.repeat?a.repeat:0,this.elapsedTime=0,this.delay="number"==typeof a.delay?1e3*a.delay:1e3,this.update=this.update.bind(this),this.update._mScope=a.scope,CMP.App.addUpdate(this.update)},CMP.Action.prototype={update:function(a){var b=a.delta;this.elapsedTime+=b,this.elapsedTime>=this.delay&&(this.callback(),"number"==typeof this.repeat&&this.repeat>0?(this.repeat--,this.elapsedTime%=this.delay):this.repeat?this.elapsedTime%=this.delay:this.stop())},stop:function(){CMP.App.removeUpdate(this.update)}},CMP.Progress=function(a){CMP.Analytics&&CMP.Analytics.Progress(a),CMP._heatInstance&&CMP._heatInstance.progress(a);var b=a.toLowerCase();"finished"!=b&&"endscreen"!=b&&"end"!=b&&"endcard"!=b||(CMP.Partner.Finished(),CMP.Analytics&&CMP.Analytics.Finished())},CMP.Log=function(a,b){if(AppConfig&&"number"==typeof AppConfig.LOG_LEVEL&&"number"==typeof a&&AppConfig.LOG_LEVEL>=a)if("string"!=typeof b&&b){if(b.type)switch(b.type){case"error":console.error("CMP Error:",b.text);case"warning":console.log("CMP Warning:",b.text);default:console.log("CMP:",b.text)}}else{var c=Array.prototype.slice.call(arguments);c.shift();var d=c.join(" ");console.log("CMP:",d)}},CMP.Log.ALL=5,CMP.Log.EXTRA=4,CMP.Log.NOTICE=3,CMP.Log.WARNING=2,CMP.Log.ERROR=1,CMP.Log.NONE=0,CMP.getParameterByName=function(a,b){try{b||(b=window.location.search.substring(1)),""===b&&(b=window.parent.location.search.substring(1))}catch(a){return CMP.Log(CMP.Log.ERROR,"Error access window.location.search"),CMP.Log(CMP.Log.ERROR,a),null}parse=b.split("?"),querystring=parse[parse.length-1],variables=querystring.split("&");for(var c=0;c<variables.length;c++)if(pair=variables[c].split("="),decodeURIComponent(pair[0])==a)return decodeURIComponent(pair[1]);return null},CMP.assign=function(a,b){if(!b)return a;for(var c in b)a[c]=b[c];return a},CMP.Onload={checkPartners:function(){CMP.Partner.Onload()}},CMP.Resize={checkPartners:function(a){var b=CMP.Partner.Resize(a);return this.widthToUse=b.w,this.heightToUse=b.h,{w:this.widthToUse,h:this.heightToUse}}},CMP.URL={open:function(a){CMP.Partner.Open(a)||CMP.Log(CMP.Log.ERROR,"Failed to find something to open with")}},CMP.StripProtocol=function(a){if("string"!=typeof a)return"";for(var b=["https://","https:/","https:","https","http://","http:/","http:","http"],c=0;c<b.length;c++){var d=b[c];if(a.substr(0,d.length)==d)return CMP.StripProtocol(a.substr(d.length))}return a},CMP.callCTA=function(a,b){var c=CMP.Partner.GetURL();c||(c="Android"===CMP.getMobileOS()?a:b),c=CMP.StripProtocol(c),c=("http:"!==location.protocol&&"https:"!==location.protocol?"https:":location.protocol)+"//"+c,CMP.Partner.CTA(c)||CMP.Log(CMP.Log.ERROR,"Failed to find something to open with"),CMP.Progress("ctaClicked")},CMP.getMobileOS=function(){var a=navigator.userAgent||navigator.vendor||window.opera;return/windows phone/i.test(a)?"Windows Phone":/android/i.test(a)?"Android":/iPad|iPhone|iPod/.test(a)&&!window.MSStream?"iOS":"unknown"},CMP.openUsingWindow=function(a){if("undefined"!=typeof window){try{window.open(a,"_blank")}catch(a){return!1}return!0}return!1},CMP.Text=function(a,b,c){var d=a;"string"==typeof a&&(a={text:d,font:b,color:c}),this.defineSetters(),this.construct(a.text),Object.assign(this,a),CMP.App._applyListenTemplate(this)},CMP.Text.prototype={listensTo:[],x:0,y:0,registrationX:.5,registrationY:.5,_markedForRemoval:!1,defineSetters:function(){this.defineWithSetCallback("text",this._updateDimensions.bind(this)),this.defineWithSetCallback("color",this._updateTextCache.bind(this)),this.defineWithSetCallback("outline",this._updateTextCache.bind(this)),this.defineWithSetCallback("underline",this._updateTextCache.bind(this)),this.defineWithSetCallback("textShadow",this._updateShadow.bind(this)),this.defineWithSetCallback("textAlign",this._updateTextCache.bind(this)),this.defineWithSetCallback("font",this._updateDimensions.bind(this)),this.defineWithSetCallback("parent",CMP.App.resizeTemplate.bind(this))},defineWithSetCallback:function(a,b){var c=null;Object.defineProperty(this,a,{get:function(){return c},set:function(a){this.property=c=a,b()}})},_updateShadow:function(){this.textShadow?this.addShadow():this.shadow=null},_updateTextCache:function(){this._updateWebGL()},_updateDimensions:function(){var a=this.getBounds();this.width=a&&"number"==typeof a.width?a:0,this.height=a&&"number"==typeof a.height?a:0,this._updateWebGL()},markForRemoval:function(){if(!this._markedForRemoval){this._markedForRemoval=!0;for(var a=this.listensTo.length-1;a>=0;a--)this.removeListen(this.listensTo[a]);if(this._cleanupEventTypes)for(var b=this._cleanupEventTypes.length-1;b>=0;b--)this.removeListen(this._cleanupEventTypes[b]);this.parent&&"function"==typeof this.parent.removeChild&&this.parent.removeChild(this),this._onRemoval()}},resize:function(a){},_onRemoval:function(){CMP.App.stage.removeEventListener("resize",this._resizeListener),this.onRemoval()},onRemoval:function(){},_drawTextLine:function(a,b,c){this.outline&&(a.strokeStyle=this.outline.color||"white",a.lineWidth=this.outline.thickness||6,a.lineJoin="round",a.strokeText(b,0,c,this.maxWidth||65535),a.fillStyle=this.color||"black"),a.fillText(b,0,c,this.maxWidth||65535),this.underline&&this.addUnderline(a,b,c)},addShadow:function(){this.shadow=new createjs.Shadow(this.textShadow.color||"black",void 0!==this.textShadow.offsetX?this.textShadow.offsetX:10,void 0!==this.textShadow.offsetY?this.textShadow.offsetY:1,this.textShadow.blurFactor||1)},addUnderline:function(a,b,c){var d=a.measureText(b).width,e=0;"center"===this.textAlign?(d/=2,e=-1*d):"right"===this.textAlign&&(e=-d,d=0)," "===b[0]&&(e+=this.calculateWhiteSpace(a,b,!0))," "===b[b.length-1]&&(d-=this.calculateWhiteSpace(a,b,!1));var f=c+(this.underline.offset||0);"top"===this.textBaseline?f+=this.lineHeight||this.getMeasuredLineHeight():"middle"===this.textBaseline?f+=(this.lineHeight||this.getMeasuredLineHeight())/2:"alphabetic"===this.textBaseline?f+=(this.lineHeight||this.getMeasuredLineHeight())/5:"hanging"===this.textBaseline&&(f+=(this.lineHeight||this.getMeasuredLineHeight())/1.25),a.beginPath(),a.strokeStyle=this.color||"black",a.lineWidth=this.underline.thickness||1,a.moveTo(e,f),a.lineTo(d,f),a.stroke(),a.closePath()},calculateWhiteSpace:function(a,b,c){for(var d="",e=c?0:b.length-1;e<b.length&&" "===b[e];c?e++:e--)d+=" ";return a.measureText(d).width},_updateWebGL:function(){if(CMP.App.webGLEnabled){this.uncache();var a=this.getBounds();a&&this.cache(a.x,a.y,a.width,a.height)}}},extend("CMP.Text","Text");var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};CMP.Tween=function(a,b){this.from={},this.to={},this.target=b,this.finished=!1,this.forward=!0,this.tweenTime=0,"object"===_typeof(a.sequence)&&a.sequence.length&&(this.tweenTime+=a.delay?-a.delay:0,this.loopDelay=a.delay?a.delay:0,this.sequenceComplete="function"==typeof a.onComplete&&a.onComplete,this.sequenceRewind=!!a.rewind&&a.rewind,this.sequenceLoop=a.loop?a.loop:1,this.sequenceId=0,this.sequence=a.sequence,this.originalParams=a,a=this.sequence[this.sequenceId]),this.prepareParams(a)},CMP.Tween.prototype={prepareParams:function(a){this.loopCount=0,this.loopDelay=!!a.loopDelay&&a.loopDelay,this.tweenTime+=a.delay?-a.delay:0,this.delay=a.delay?a.delay:0,this.duration=a.duration?a.duration:1,this.repeat=!!a.repeat&&a.repeat,this.rewind=!!a.rewind&&a.rewind,this.easingFunction=a.easing?a.easing:CMP.Tween.Linear,this.onComplete="function"==typeof a.onComplete&&a.onComplete,this.loop=a.loop?a.loop:1,this.rewind&&1===this.loop&&(this.loop=2);for(var b in a)"layout"==b?(this.from.layout={},"function"==typeof this.target.layout&&(this.originalLayoutFunc=this.target.layout,this.target.layout=this.originalLayoutFunc(this.target.parent.width/this.target.parent.height)),Object.assign(this.from.layout,this.target.layout),this.to.layout=a.layout):"duration"!==b&&"easing"!=b&&"rewind"!=b&&"loop"!=b&&"sequence"!=b&&"delay"!=b&&(this.from[b]=this.target[b],this.to[b]=a[b]);this.rewind&&this.loop%2==0&&(this.finalLayout=CMP.assign({},this.from))},pause:function(){this.paused=!0},resume:function(){this.paused=!1},advance:function(a){if(!(this.paused||(this.tweenTime+=a,this.finished||this.tweenTime<0)))return this.tweenTime>this.duration?(this.tweenTime%=this.duration,void this.onSingleComplete()):void this.updateToPercent(this.calculatePercent())},endEarly:function(){this.rewind&&this.finalLayout&&(this.to=this.finalLayout),this.tweenComplete()},onSingleComplete:function(){if("number"==typeof this.loop){if(0===--this.loop)return void this.tweenComplete();if(this.rewind){var a=this.to;this.to=this.from,this.from=a}}else{if(!this.loop)return void this.tweenComplete();if(this.rewind){var b=this.to;this.to=this.from,this.from=b}}if(this.loopDelay){this.loopCount++;var c=this.rewind?2:1;this.loopCount==c&&(this.loopCount=0,this.tweenTime-=this.loopDelay)}},tweenComplete:function(){if(this.tweenTime=this.duration,this.finished=!0,this.updateToPercent(1),this.onComplete&&this.onComplete(),this.sequence)if(++this.sequenceId<this.sequence.length){this.tweenTime=0,this.from={},this.to={},this.forward=!0;var a=this.sequence[this.sequenceId];this.prepareParams(a),this.finished=!1}else this.sequenceComplete&&this.sequenceComplete();else this.originalLayoutFunc&&(this.target.layout=this.originalLayoutFunc)},setToParams:function(a){for(var b in a)"layout"==b?this.to.layout=a.layout:"duration"!==b&&"easing"!=b&&"rewind"!=b&&"loop"!=b&&"sequence"!=b&&"delay"!=b&&(this.to[b]=a[b])},updateToPercent:function(a){for(var b in this.to)if("layout"!=b)this.target[b]=this.from[b]+(this.to[b]-this.from[b])*a;else{this.originalLayoutFunc&&!this.rewind&&(this.from.layout=this.originalLayoutFunc(this.target.parent.width/this.target.parent.height));for(var c in this.to.layout){var d=this.to.layout[c]-this.from.layout[c];this.target.layout[c]=this.from.layout[c]+d*a}"function"==typeof this.target._resize&&this.target._resize()}},calculatePercent:function(){var a=this.tweenTime/this.duration;if("function"==typeof this.easingFunction){var b=this.easingFunction(a);a="number"==typeof b?b:a}return a}},CMP.Tween.Linear=function(a){return a},CMP.Tween.Quad={In:function(a){return a*a},Out:function(a){return-a*(a-2)},InOut:function(a){return(a*=2)<1?.5*a*a:-.5*(--a*(a-2)-1)}},CMP.Tween.Cubic={In:function(a){return a*a*a},Out:function(a){return(a-1)*(a-1)*(a-1)+1},InOut:function(a){return(a*=2)<1?.5*a*a*a:.5*((a-2)*(a-2)*(a-2)+2)}},CMP.Tween.Quart={In:function(a){return a*a*a*a},Out:function(a){return-1*(--a*a*a*a-1)},InOut:function(a){return(a*=2)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)}},CMP.Tween.Quint={In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}},CMP.Tween.Sine={In:function(a){return-1*Math.cos(a*(Math.PI/2))+1},Out:function(a){return Math.sin(a*(Math.PI/2))},InOut:function(a){return-.5*(Math.cos(Math.PI*a)-1)}},CMP.Tween.Expo={In:function(a){return 0==a?0:Math.pow(2,10*(a-1))},Out:function(a){return 1==a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0==a||1==a?a:(a*=2)<1?.5*Math.pow(2,10*(a-1)):.5*(2-Math.pow(2,-10*--a))}},CMP.Tween.Circ={In:function(a){return-1*(Math.sqrt(1-a*a)-1)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return(a*=2)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},CMP.Tween.Elastic={In:function(a){return 0==a||1==a?a:-Math.pow(2,10*(a-=1))*Math.sin((a-.075)*(2*Math.PI)/.3)},Out:function(a){return 0==a||1==a?a:Math.pow(2,-10*a)*Math.sin((a-.075)*(2*Math.PI)/.3)+1},InOut:function(a){var b=.1125,c=.45;return 0==a?a:2==(a*=2)?1:a<1?Math.pow(2,10*(a-=1))*Math.sin((a-b)*(2*Math.PI)/c)*-.5:Math.pow(2,-10*(a-=1))*Math.sin((a-b)*(2*Math.PI)/c)*.5+1}},CMP.Tween.Back={In:function(a){var b=1.70158;return a*a*((b+1)*a-b)},Out:function(a){var b=1.70158;return--a*a*((b+1)*a+b)+1},InOut:function(a){var b=1.70158;return(a*=2)<1?a*a*((1+(b*=1.525))*a-b)*.5:.5*((a-=2)*a*((1+(b*=1.525))*a+b)+2)}},CMP.Tween.Bounce={In:function(a){return 1-CMP.Tween.Bounce.Out(1-a)},Out:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return a<.5?.5*CMP.Tween.Bounce.In(2*a):.5*CMP.Tween.Bounce.Out(2*a-1)+.5}},CMP.DisplayObject=function(a){this.defineSetters(),this.construct(a),this.ctage=CMP.App.stage,this.x=this.y=this.width=this.height=0,Object.assign(this,a),this._updateGraphics(),CMP.App.applyTemplates(this)},CMP.DisplayObject.prototype={listensTo:[],registrationX:.5,registrationY:.5,_markedForRemoval:!1,defineSetters:function(){this.defineWithSetCallback("width",this._updatedDimensions.bind(this)),this.defineWithSetCallback("height",this._updatedDimensions.bind(this)),this.defineWithSetCallback("cornerRadius",this._updatedDimensions.bind(this)),this.defineWithSetCallback("backgroundColor",this._updateGraphics.bind(this)),this.defineWithSetCallback("parent",CMP.App.resizeTemplate.bind(this)),this.defineWithSetCallback("scale",this._setScale.bind(this))},defineWithSetCallback:function(a,b){var c=this[a];Object.defineProperty(this,a,{get:function(){return c},set:function(a){this.property=c=a,b()}})},_setScale:function(a){a="number"==typeof a?a:this.scale,this.scaleX=this.scaleY=a},_updatedDimensions:function(){this.width&&this.height&&!this.layout&&("number"==typeof this.registrationX&&(this.regX=this.width*this.registrationX,"number"==typeof this._offsetRegX&&(this.regX+=this._offsetRegX)),"number"==typeof this.registrationY&&(this.regY=this.height*this.registrationY,"number"==typeof this._offsetRegY&&(this.regY+=this._offsetRegY))),this._updateHitArea(this.width,this.height),this._updateGraphics()},_updateGraphics:function(){this.backgroundColor&&this.graphics&&"number"==typeof this.width&&"number"==typeof this.height&&"number"==typeof this.cornerRadius?(this.graphics.clear(),this.graphics.beginFill(this.backgroundColor).drawRoundRect(0,0,this.width,this.height,this.cornerRadius),this._updateWebGL()):this.backgroundColor&&this.graphics&&"number"==typeof this.width&&"number"==typeof this.height&&(this.graphics.clear(),this.graphics.beginFill(this.backgroundColor).drawRect(0,0,this.width,this.height),this._updateWebGL())},markForRemoval:function(){if(!this._markedForRemoval){this._markedForRemoval=!0;for(var a=this.listensTo.length-1;a>=0;a--)this.removeListen(this.listensTo[a]);if(this._cleanupEventTypes)for(var b=this._cleanupEventTypes.length-1;b>=0;b--)this.removeListen(this._cleanupEventTypes[b]);this.parent&&"function"==typeof this.parent.removeChild&&this.parent.removeChild(this),this._onRemoval()}},resize:function(a){},_onRemoval:function(){this.ctage.removeEventListener("resize",this._resizeListener),this.onRemoval()},onRemoval:function(){},setBackgroundColor:function(){},addHitArea:function(a,b,c,d){this.removeHitArea();var e="number"==typeof b?b:this.width,f="number"==typeof c?c:this.height,g="number"==typeof d?d:this.cornerRadius;this._updateHitArea(e,f,g),a="function"==typeof a?a:function(){},this._hitAreaListener=this.on("click",a)},removeHitArea:function(){this._hitAreaListener&&(this.off("click",this._hitAreaListener),this.hitArea=!1)},_updateHitArea:function(a,b,c){this.hitArea="number"==typeof c?new createjs.Shape((new createjs.Graphics).beginFill("#fff").drawRoundRect(0,0,a,b,c)):new createjs.Shape((new createjs.Graphics).beginFill("#fff").drawRect(0,0,a,b))},sendToBack:function(){if(this.parent&&this.parent.children)for(var a=this,b=0;b<this.parent.children.length;b++){if(this.parent.children[b]===this)return void(this.parent.children[b]=a);var c=this.parent.children[b];this.parent.children[b]=a,a=c}},setSprite:function(){},_updateWebGL:function(){CMP.App.webGLEnabled&&this._background&&(this._background.uncache(),this._background.cache(-this.width,-this.height,2*this.width,2*this.height))}},extend("CMP.DisplayObject","Shape"),CMP.DisplayObjectContainer=function(a){var b={x:0,y:0,registrationX:0,registrationY:0,width:500,height:500,layout:"match"};this.defineSetters(),"match"!=this.layout&&"match"!=a.layout||Object.assign(this,b),"match"===a&&(a=b),this.construct(a),this.ctage=CMP.App.stage,Object.assign(this,a),this._updatedDimensions(),CMP.App.applyTemplates(this)},CMP.DisplayObjectContainer.prototype={listensTo:[],registrationX:.5,registrationY:.5,_markedForRemoval:!1,defineSetters:function(){this.defineWithSetCallback("width",this._updatedDimensions.bind(this)),this.defineWithSetCallback("height",this._updatedDimensions.bind(this)),this.defineWithSetCallback("backgroundColor",this._updateBackground.bind(this)),this.defineWithSetCallback("parent",CMP.App.resizeTemplate.bind(this)),this.defineWithSetCallback("text",this._updateText.bind(this)),this.defineWithSetCallback("scale",this._setScale.bind(this))},defineWithSetCallback:function(a,b){var c=this[a];Object.defineProperty(this,a,{get:function(){return c},set:function(a){this.property=c=a,b()}})},_setScale:function(a){a="number"==typeof a?a:this.scale,this.scaleX=this.scaleY=a},_updateText:function(){this._text?this._text.text=this.text:this._text=this.addChild(new CMP.Text(this.text))},_updatedDimensions:function(){!this.width||!this.height||this.layout&&"match"!==this.layout||("number"==typeof this.registrationX&&(this.regX=this.width*this.registrationX,"number"==typeof this._offsetRegX&&(this.regX+=this._offsetRegX)),"number"==typeof this.registrationY&&(this.regY=this.height*this.registrationY,"number"==typeof this._offsetRegY&&(this.regY+=this._offsetRegY))),this._updateBackground()},_updateBackground:function(){this.backgroundColor&&"number"==typeof this.width&&"number"==typeof this.height?this._background?(this._background.backgroundColor=this.backgroundColor,this._background.width=this.width,this._background.height=this.height):(this._background=this.addChild(new CMP.DisplayObject({backgroundColor:this.backgroundColor,registrationX:0,registrationY:0,x:0,y:0,width:this.width,height:this.height})),this._background.sendToBack()):this._background&&(this._background.markForRemoval(),this._background=void 0),this._updateWebGL()},sendToBack:function(){if(this.parent&&this.parent.children)for(var a=this,b=0;b<this.parent.children.length;b++){if(this.parent.children[b]===this)return void(this.parent.children[b]=a);var c=this.parent.children[b];this.parent.children[b]=a,a=c}},markForRemoval:function(){if(!this._markedForRemoval){this._markedForRemoval=!0;for(var a=this.listensTo.length-1;a>=0;a--)this.removeListen(this.listensTo[a]);if(this._cleanupEventTypes)for(var b=this._cleanupEventTypes.length-1;b>=0;b--)this.removeListen(this._cleanupEventTypes[b]);if(this.parent&&"function"==typeof this.parent.removeChild&&this.parent.removeChild(this),this.children&&this.children.length>0)for(var c=this.children.length-1;c>=0;c--){var d=this.children[c];d&&"function"==typeof d.markForRemoval&&d.markForRemoval()}this._onRemoval()}},resize:function(a){},addHitArea:function(a,b,c){this.removeHitArea();var d="number"==typeof b?b:this.width,e="number"==typeof c?c:this.height;this.hitArea=new createjs.Shape((new createjs.Graphics).beginFill("#fff").drawRect(0,0,d,e)),a="function"==typeof a?a:function(){},this._hitAreaListener=this.on("click",a)},removeHitArea:function(){this._hitAreaListener&&(this.off("click",this._hitAreaListener),this.hitArea=!1)},_onRemoval:function(){this.ctage.removeEventListener("resize",this._resizeListener),this.onRemoval()},onRemoval:function(){},_addToFilterList:function(a){a&&(this.filters||(this.filters=[]),this.filters.push(a))},_applyColorFilter:function(a,b,c,d,e,f,g,h){this._undoColorFilter(),a="number"==typeof a?a:0,b="number"==typeof b?b:0,c="number"==typeof c?c:0,d="number"==typeof d?d:0,e="number"==typeof e?e:0,f="number"==typeof f?f:0,g="number"==typeof g?g:0,h="number"==typeof h?h:0,this.colorFilter=new createjs.ColorFilter(a,b,c,d,e,f,g,h),this._addToFilterList(this.colorFilter),this.cache(0,0,this.width,this.height)},_undoColorFilter:function(a){this._undoFilter("colorFilter",a)},_applyColorAdjustmentFilter:function(a,b,c,d){this._undoColorAdjustmentFilter(),a="number"==typeof a?a:-300,b="number"==typeof b?b:-300,c="number"==typeof c?c:-300,d="number"==typeof d?d:-300;var e=new createjs.ColorMatrix;d>=-180&&d<=180&&e.adjustHue(d),b>=-100&&b<=100&&e.adjustContrast(b),a>=-255&&a<=255&&e.adjustBrightness(a),c>=-100&&c<=100&&e.adjustSaturation(c),this.colorAdjFilter=new createjs.ColorMatrixFilter(e),this._addToFilterList(this.colorAdjFilter),this.cache(0,0,this.width,this.height)},_undoColorAdjustmentFilter:function(a){this._undoFilter("colorAdjFilter",a)},_blur:function(a,b,c){this._unblur(),a="number"==typeof a?a:10,b="number"==typeof b?b:10,c="number"==typeof c?c:1,this.blurFilter=new createjs.BlurFilter(a,b,c),this._addToFilterList(this.blurFilter);var d=this.blurFilter.getBounds();this.cache(0+d.x,0+d.y,this.width+d.width,this.height+d.height)},_unblur:function(a){this._undoFilter("blurFilter",a)},_undoFilter:function(a,b){if(this[a]){var c=!1;if(this.filters){var d=this.filters.indexOf(this[a]);d>-1&&this.filters.splice(d,1),this.filters.length>0&&(c=!0)}this[a]=void 0,this.uncache(),b||c&&this.updateCache()}},_clearFilters:function(){this.filters=null,this.uncache()},_updateWebGL:function(){CMP.App.webGLEnabled&&this._background&&(this._background.uncache(),this._background.cache(-this.width,-this.height,2*this.width,2*this.height),this.filters&&(this.filters.length>0?this.updateCache():this.uncache()))}},extend("CMP.DisplayObjectContainer","Container"),CMP.CachedContainer=function(a){this.origCacheFunc=CMP.DisplayObjectContainer.prototype.cache,this.imgType=this.imgType?this.imgType:"image/png",this.imgQuality=this.imgQuality?this.imgQuality:.92,this.construct(a)},CMP.CachedContainer.prototype={cache:function(){if(this.children&&!(this.children.length<1)){var a={x:0,y:0,width:0,height:0,centerX:0,centerY:0};this.childrenBounds={leftMostX:Number.MAX_SAFE_INTEGER,rightMostX:Number.MIN_SAFE_INTEGER,topMostY:Number.MAX_SAFE_INTEGER,lowestY:Number.MIN_SAFE_INTEGER},this.offsetX=0,this.offsetY=0,this.children.forEach(function(a){a.scaleX<0&&(this.offsetX=Math.abs(a.scaleX)*a.width),a.scaleY<0&&(this.offsetY=Math.abs(a.scaleY)*a.height);var b=a.x-Math.abs(a.scaleX*a.regX),c=a.y-Math.abs(a.scaleY*a.regY);b<this.childrenBounds.leftMostX&&(this.childrenBounds.leftMostX=b),c<this.childrenBounds.topMostY&&(this.childrenBounds.topMostY=c),b+a.width*Math.abs(a.scaleX)>this.childrenBounds.rightMostX&&(this.childrenBounds.rightMostX=b+a.width*Math.abs(a.scaleX)),c+a.height*Math.abs(a.scaleY)>this.childrenBounds.lowestY&&(this.childrenBounds.lowestY=c+a.height*Math.abs(a.scaleY))}.bind(this)),a.x=this.childrenBounds.leftMostX,a.y=this.childrenBounds.topMostY,a.width=this.childrenBounds.rightMostX-this.childrenBounds.leftMostX+this.offsetX,a.height=this.childrenBounds.lowestY-this.childrenBounds.topMostY,a.centerX=a.x+a.width/2,a.centerY=a.y+a.height/2,this.forceBounds&&(a={x:0,y:0,width:this.width,height:this.height,centerX:this.width/2,centerY:this.height/2}),this.drawToCanvas(a)}},drawToCanvas:function(a){var b=document.createElement("canvas"),c=b.getContext("2d");if(b.width=this.width+this.offsetX,b.height=this.height+this.offsetY,c.save(),this.children.forEach(function(a){if(a.text){var c=this.getLineWidth(a.text,a),d=Math.ceil(c/a.lineWidth),e=d*this.getLineHeight(a.text,a);b.height=e>b.height?e:b.height}}.bind(this)),this.children.forEach(function(d){if(d.text){this.drawY=d.y;for(var e=d.text.split(" "),f="";e.length>0;){""!=f&&(f+=" ");var g=f+e[0];this.getLineWidth(g,d)>d.lineWidth?(""==f?(this.drawLine(g,c,d),e.shift()):this.drawLine(f,c,d),f=""):f+=e.shift()}""!=f&&this.drawLine(f,c,d)}else{d.exportWidth=d.exportWidth?d.exportWidth:d.width*Math.abs(d.scaleX),d.exportHeight=d.exportHeight?d.exportHeight:d.height*Math.abs(d.scaleY);var h=d.rotation*Math.PI/180,i=(d.exportWidth,this.width,d.regX,d.exportHeight,this.height,d.regY,d.scaleX<0?-1*d.x-Math.abs(d.scaleX*d.regX)+a.x-this.offsetX:d.x-Math.abs(d.scaleX*d.regX)-a.x+this.offsetX),j=d.scaleY<0?-1*d.y-Math.abs(d.scaleY*d.regY)+a.y-this.offsetY:d.y-Math.abs(d.scaleY*d.regY)-a.y+this.offsetY,k=d.exportWidth,l=d.exportHeight;i+=(this.width-d.exportWidth)/2,j+=(this.height-d.exportHeight)/2,d.rotation&&(c.translate(b.width/2,b.height/2),c.rotate(h),i=-k/2,j=-l/2),d.cache(0,0,d.width,d.height),c.globalAlpha=d.alpha,c.scale(d.scaleX<0?-1:1,d.scaleY<0?-1:1),c.drawImage(d.cacheCanvas,i,j,k,l),c.translate(0,0),c.setTransform(1,0,0,1,0,0)}}.bind(this)),c.restore(),this.cropPercentage){var d=document.createElement("canvas"),e=d.getContext("2d"),f=this.width*this.cropPercentage.left,g=this.height*this.cropPercentage.top;d.width=this.width-this.width*(this.cropPercentage.left+this.cropPercentage.right)+this.offsetX,d.height=this.height-this.height*(this.cropPercentage.top+this.cropPercentage.bottom)+this.offsetY,e.drawImage(b,f,g,d.width,d.height,0,0,d.width,d.height),b=d}var h="";try{this.origCachedSrc=b.toDataURL(this.imgType,this.imgQuality),h=b.toDataURL("image/webp",this.imgQuality)}catch(a){}if(""!==h){var i=new Image;i.src=h;for(var j=this.children.length-1;j>=0;j--)this.children[j]!=this._background&&this.children[j].markForRemoval();var k=this.addChild(new CMP.DisplayObject({x:b.width/2-this.offsetX,y:b.height/2-this.offsetY,width:b.width,height:b.height}));k.img=i,i.onload=this.onImgLoad.bind(this,k,i),this.cachedSrc=h}else{this.cropPercentage?this.origCacheFunc(this.width*this.cropPercentage.left,this.height*this.cropPercentage.top,b.width,b.height):this.origCacheFunc(a.x,a.y,a.width,a.height);for(var j=this.children.length-1;j>=0;j--)this.children[j]!=this._background&&this.children[j].markForRemoval()}},onImgLoad:function(a,b){this._redrawImg(a,b),"function"==typeof this.onComplete&&this.onComplete(b)},getLineWidth:function(a,b){var c=b.text;b.text=a;var d=b.getMeasuredWidth();return b.text=c,d},getLineHeight:function(a,b){var c=b.text;b.text=a;var d=b.getMeasuredHeight();return b.text=c,d},drawLine:function(a,b,c){a=a.trim();this.getLineWidth(a,c);b.font=c.font,b.textAlign=c.textAlign;var d=0;d="center"==c.textAlign?c.lineWidth/2:d,d="right"==c.textAlign?c.lineWidth:d,b.fillStyle=c.color,b.font=c.font,b.fillText(a,c.x+d,this.drawY),this.drawY+=this.getLineHeight(a,c)},_redrawImg:function(a,b){a.img&&a.img.complete?(a.graphics.clear(),a.graphics.beginBitmapFill(b,"no-repeat").drawRect(0,0,a.width,a.height)):a.img&&!a.img.complete&&setTimeout(this._redrawImg.bind(this,a,b),2e3)}},extend("CMP.CachedContainer","CMP.DisplayObjectContainer"),CMP.Audio=function(a){this.construct(a),a&&(this.setAudio(a.id),a.loop&&this.setLoop(!0))},CMP.Audio.prototype={width:300,height:600,setAudio:function(a){AppConfig.DISABLE_AUDIO||"string"!=typeof a||this._audio==a&&this.audioController||(this._audio=a,this.audioController=CMP.App.getAudio(a),this.audioController&&(this.audio=this.audioController.audioElement,this.audioController.applyControls(this)),this.checkReady())},addDisplay:function(){AppConfig.DISABLE_AUDIO||(this.audioController.visibleComponent=!0,this.audioController.addComponent(),this.addChild(this.audioController))},play:function(a){this.checkReady("play")&&this.playAudio(a)},playFromStart:function(){this.checkReady("play")&&(this.seeking(0),this.audioController.playing||this.playAudio())},setLoop:function(a){this.audioController&&(this.audioController.loop=a)},addEventListener:function(a,b){if(this.audioController)return this.audioController.addEventListener(a,b);CMP.Log(CMP.Log.EXTRA,"No audio controller found for id '"+this._audio+"'. Could not add event listener")},removeEventListener:function(a,b){if(this.audioController)return this.audioController.removeEventListener(a,b);CMP.Log(CMP.Log.EXTRA,"No audio controller found for id '"+this._audio+"'. Could not remove event listener")},loadAudio:function(a){this.audioController.loadAudio(a)},pause:function(){this.checkReady("pause")&&this.pauseAudio()},checkReady:function(a){return!AppConfig.DISABLE_AUDIO&&(this.audioController?(this.ready=this.audioController.checkLoad(),this.ready?void 0===this.playAudio&&this.audioController.applyControls(this):("play"===a&&this.audioController.setAutoplay(!0),"pause"===a&&this.audioController.setAutoplay(!1),this.audioController.config.loadOnDemand||this.audioController.loadAudio()),this.ready):void CMP.Log(CMP.Log.EXTRA,"No audio controller found for id '"+this._audio+"'"))},mute:function(){this.toggleMute(!0)},unmute:function(){this.toggleMute(!1)},toggleMute:function(a){this.checkReady("pause")&&this.audioController.toggleMute(a)},getAudioController:function(){return this.audioController}},extend("CMP.Audio","CMP.DisplayObjectContainer"),CMP.AudioManager=function(a){this.ready=!1,this._eventListeners=[],this.stopPlaying=this.stopPlaying.bind(this),this.construct(a),this.config.audioLoaders.push(this),this.init()},CMP.AudioManager.prototype={width:300,height:600,x:150,y:300,init:function(){CMP.Log(CMP.Log.EXTRA,"AudioManager",this.config.id,"Initializing"),this.createElement(),this.visibleComponent&&this.addComponent(),this.preload=!0},createElement:function(){var a=this.config.mp3?this.config.mp3:this.config.ogg?this.config.ogg:this.config.src;this.audioElement=new Howl({src:a}),this.audioElement.src=this.audioElement._src,this.audioElement.preload=!0,this.audioElement.autoplay=!1;for(var b=["load","loaderror","playerror"],c=0;c<b.length;c++)this.audioElement.on(b[c],this.handleEvent.bind(this,b[c]));for(var d=["play","end","stop","pause","fade","volume","seek"],e=0;e<d.length;e++)this.audioElement.on(d[e],this.handleEvent.bind(this,d[e]));return this.audioElement},delayLoad:function(){return!0},loadAudio:function(a){this.loadStarted||("iOS"!==CMP.getMobileOS()||a?(CMP.Log(CMP.Log.EXTRA,"Beginning to load audio",this.config.id),this._loadProcess()):(CMP.Log(CMP.Log.EXTRA,"AudioManager",this.config.id,"Load on first click set"),this.loadOnFirstClick()),this.loadStarted=!0)},loadOnFirstClick:function(){this.loadStarted||(this.loadStarted=!0,CMP.Log(CMP.Log.EXTRA,"Added first click listener for",this.config.id),this.onFirstClick=this.onFirstClick.bind(this),CMP.App.stage.addEventListener("stagemousedown",this.onFirstClick),CMP.Log(CMP.Log.EXTRA,"AudioManager",this.config.id,"Called on complete early"),this.callOnComplete())},callOnComplete:function(){this.calledOnComplete||"function"!=typeof this.onComplete||(setTimeout(this.onComplete.bind(this),10),this.calledOnComplete=!0)},onFirstClick:function(a){CMP.App.stage.removeEventListener("stagemousedown",this.onFirstClick),this._loadProcess()},_loadProcess:function(){if(!AppConfig.DISABLE_AUDIO){var a=this.selectAudioToLoad();CMP.Log(CMP.Log.EXTRA,"Selected audio type",a,"from",this.config[a]),this.url=this.config[a],this.audioElement.src=this.config[a],this.autoplay||(this.audioElement.on("play",{handleEvent:this.stopPlaying}),this.audioElement.autoplay=!0,this.audioElement.muted=!0),CMP.Log(CMP.Log.EXTRA,"AudioManager",this.config.id,"Assigned src to load")}},stopPlaying:function(){this.audioElement.removeEventListener("playing",this.stopPlaying),this.autoplay||(CMP.Log(CMP.Log.EXTRA,"Stop playing",this.config.id),this.audioElement.pause()),this.updateMuted()},generateCanPlay:function(){if(!this.canPlay){this.canPlay={mp3:"",mp4:"",ogg:"",webm:"",flac:"",caf:""};var a=document.createElement("audio");this.canPlay.mp3=a.canPlayType("audio/mpeg"),this.canPlay.mp4=a.canPlayType("audio/mp4"),this.canPlay.ogg=a.canPlayType("audio/ogg"),this.canPlay.webm=a.canPlayType("audio/webm"),this.canPlay.flac=a.canPlayType("audio/flac"),this.canPlay.caf=a.canPlayType("audio/caf")}},selectAudioToLoad:function(){this.generateCanPlay();var a="ogg",b=this.config,c=(b.id,b.mp3),d=b.ogg;if(d&&this.canPlay.ogg.length>0&&"probably"==this.canPlay.ogg)a="ogg";else if(c&&this.canPlay.mp3.length>0&&"probably"==this.canPlay.mp3)a="mp3";else for(var e in this.config)this.config.hasOwnProperty(e)&&"id"!=e&&this.canPlay[e]&&this.canPlay[e].length>0&&"probably"==this.canPlay[e]&&(a=e);if("probably"==this.canPlay[a])return a;if(d&&this.canPlay.ogg.length>0)a="ogg";else if(c&&this.canPlay.mp3.length>0)a="mp3";else for(var e in this.config)this.config.hasOwnProperty(e)&&"id"!=e&&this.canPlay[e]&&this.canPlay[e].length>0&&(a=e);return a},addComponent:function(){this.visibleComponent&&(this.width=300,this.height=600,this.backgroundColor="#e2e2e2",this.createTextField(100,50,"preload","preload"),this.createTextField(100,75,"autoplay","autoplay"),this.createTextField(100,100,"loadStart","loadstart"),this.createTextField(100,125,"onLoadData","loadeddata"),this.createTextField(100,150,"loadedMetaData","loadedmetadata"),this.createTextField(100,175,"muted","muted",this.audioElement),this.createTextField(100,200,"readyState","readyState",this.audioElement),this.createTextField(100,225,"MasterSound","MasterSound",CMP),this.createTextField(100,250,"paused","paused",this.audioElement),this.createTextField(100,275,"currentTime","currentTime",this.audioElement),this.createTextField(100,300,"playing","playing",this),this.createButton(.15,.58,"#fff","Play",this.playAudio.bind(this)),this.createButton(.4,.58,"#6aa","Pause",this.pauseAudio.bind(this)),this.createButton(.65,.58,"#592","-30",this.adjustTime.bind(this,-30)),this.createButton(.15,.7,"#44f","Volume\nUp",this.adjustVolume.bind(this,.05)),this.createButton(.4,.7,"#8a5","Volume\nDown",this.adjustVolume.bind(this,-.05)),this.createButton(.65,.7,"#578","+30",this.adjustTime.bind(this,30)),this.createButton(.15,.82,"#0e4","speed\n+",this.adjustSpeed.bind(this,.1)),this.createButton(.4,.82,"#f24","speed\n-",this.adjustSpeed.bind(this,-.1)),this.createButton(.65,.82,"#578","(Un)Mute",this.toggleMute.bind(this)))},createTextField:function(a,b,c,d,e){var f=this.addChild(new CMP.DisplayObjectContainer({width:35,height:35,x:a,y:b})),g=(f.addChild(new CMP.Text({text:c,x:-25,font:"bold 12px Arial",color:"#000",textAlign:"left"})),f.addChild(new CMP.Text({text:c,x:100,font:"bold 12px Arial",color:"#000",textAlign:"left"}))),h=e||this;f.addUpdate(function(){g.text=""+h[d],g.color=h[d]?"#0a0":"#f00"}.bind(f))},createButton:function(a,b,c,d,e){var f=this.addChild(new CMP.DisplayObjectContainer({backgroundColor:c,width:35,height:35,layout:{xPercentage:a,yPercentage:b,scaleToWidth:.2,scaleToHeight:.2}}));f.addHitArea(function(a){e()}),f.addChild(new CMP.Text({text:d,x:17,y:12,font:"bold 8px Arial",textAlign:"center"}))},_onComplete:function(a){(a||4===a.readyState)&&(this.visibleComponent&&(this.createTextField(100,200,"time","currentTime",this.audioElement),this.createTextField(100,225,"duration","duration",this.audioElement),this.createTextField(100,250,"playing","playing",this),this.createTextField(100,275,"volume","volume",this.audioElement),this.createTextField(100,300,"playbackRate","playbackRate",this.audioElement)),this.ready=!0)},addEventListener:function(a,b,c){return b._remove=c,this._eventListeners[a]||(this._eventListeners[a]=[]),this._eventListeners[a].push(b),b},removeEventListener:function(a,b){this._eventListeners[a]||(this._eventListeners[a]=[]);var c=this._eventListeners[a].indexOf(b);return-1!=c&&(this._eventListeners[a].splice(c,1),!0)},handleEvent:function(a){switch(CMP.Log(CMP.Log.EXTRA,"AudioManager",this.config.id,a.type?a.type:a),a.type?a.type:a){case"loaderror":this.onLoadError(a);break;case"playerror":this.onPlayError();break;case"load":this.onLoaded();break;case"seek":this.timeUpdate();break;case"play":this.onPlaying();break;case"end":this.onEnd();break;case"stop":this.onStop();break;case"pause":this.onPause();break;case"rate":this.onRateChange();break;case"fade":this.onFade();break;case"volume":this.volumeChange()}var b=Object.assign({},a);b.type="volumechange";var c=Object.assign({},a);c.type="error";var d=Object.assign({},a);d.type="ended";var e=Object.assign({},a);e.type="playing";var f={volume:b,loaderror:c,playerror:c,end:d,play:e};this.callEventListeners(a),f[a]&&this.callEventListeners(f[a])},callEventListeners:function(a){if(!a.type){var b=a;a=Object.assign({},b),a.type=b}if(this._eventListeners[a.type]){for(var c=this._eventListeners[a.type].length-1;c>=0;c--)"function"==typeof this._eventListeners[a.type][c]&&(CMP.Log(CMP.Log.NOTICE,"Calling",a.type),this._eventListeners[a.type][c](),this._eventListeners[a.type][c]._remove&&this._eventListeners[a.type].splice(c,1));"ready"==a.type&&(CMP.Log(CMP.Log.NOTICE,"Erased ready"),this._eventListeners[a.type]=[])}},onLoadError:function(a){CMP.Log(CMP.Log.ERROR,"Got an error",a.toString()),"function"==typeof this.onError&&this.onError(this.audioElement)},onLoadStart:function(){this.loadstart=!0},loadedMetaData:function(){this.loadedmetadata=!0,this.loadComplete()},onLoaded:function(){void 0!==this.audioElement.state&&void 0!==this.audioElement._state&&("loaded"==this.audioElement.state()||"loaded"==this.audioElement._state()?(this.callEventListeners("loadeddata"),this.callEventListeners("loadedmetadata"),this.callOnComplete(),this.loadeddata=!0):"loading"!=this.audioElement.state()&&"loading"!=this.audioElement._state()||this.loadStartFired||(this.loadStartFired=!0,this.callEventListeners("loadstart")))},loadComplete:function(){this.ready||(this.ready=!0,this.loading=!1,this.callOnComplete(),CMP.Log(CMP.Log.EXTRA,"Calling ready listeners",this.config.id),this.callEventListeners({type:"ready"}))},onPlayError:function(a){CMP.Log(CMP.Log.ERROR,"Got an error",a.toString()),"function"==typeof this.onError&&this.onError(this.audioElement)},timeUpdate:function(){},onEnd:function(){this.audioElement.currentTime=0,this.playing=!1,this.loop&&this.playAudio()},onPlaying:function(){this.playing=!0},onPause:function(){this.playing=!1},onStop:function(){this.playing=!1},onRateChange:function(){},onWaiting:function(){},onFade:function(){},volumeChange:function(){},getTime:function(){return this.audioElement.currentTime=this.audioElement.seek(),this.checkLoad()?this.audioElement.currentTime:0},getDuration:function(){return this.checkLoad()?this.audioElement.duration():0},applyControls:function(a){a.stop=this.stop=this.stop.bind(this),a.getTime=this.getTime=this.getTime.bind(this),a.seeking=this.seeking=this.seeking.bind(this),a.playAudio=this.playAudio=this.playAudio.bind(this),a.pauseAudio=this.pauseAudio=this.pauseAudio.bind(this),a.adjustTime=this.adjustTime=this.adjustTime.bind(this),a.setAutoplay=this.setAutoplay=this.setAutoplay.bind(this),a.getDuration=this.getDuration=this.getDuration.bind(this),a.adjustSpeed=this.adjustSpeed=this.adjustSpeed.bind(this),a.adjustVolume=this.adjustVolume=this.adjustVolume.bind(this)},setAutoplay:function(a){this.audioElement.autoplay=this.autoplay=a},playAudio:function(a){this.setAutoplay(!0),this.checkLoad()&&(this.playing&&!a?CMP.Log(CMP.Log.NOTICE,"Tried to play",this.id,"while it was playing."):this.audioElement.play())},pauseAudio:function(){this.setAutoplay(!1),this.checkLoad()&&this.audioElement.pause()},checkLoad:function(){return"loaded"==this.audioElement.state()},seeking:function(a){if(this.checkLoad()&&!(a>1||a<0)){var b=this.audioElement.duration();this.audioElement.currentTime=b*a,this.audioElement.seek(this.audioElement.currentTime)}},stop:function(){this.checkLoad()&&(this.audioElement.currentTime=0,this.audioElement.seek(0),this.audioElement.pause())},adjustSpeed:function(a){if(this.checkLoad()){var b=this.audioElement.rate(),c=b+a;this.audioElement.rate(c)}},adjustTime:function(a){if(this.checkLoad()){var b=this.audioElement.seek(),c=this.audioElement.duration(),d=b+a;if(d>c||d<0)return void this.stop();this.audioElement.currentTime=d,this.audioElement.seek(this.audioElement.currentTime)}},adjustVolume:function(a){if(this.checkLoad()){var b=this.audioElement.volume()+a;this.audioElement.volume(Math.min(1,Math.max(0,b)))}},toggleMute:function(a){void 0===a&&(a=!this._isMuted),this._isMuted=a,this.checkLoad()&&this.updateMuted()},updateMuted:function(){this.audioElement.mute(this._isMuted||!CMP.MasterSound)},layout:{xPercentage:.5,yPercentage:.5,scaleToWidth:1,scaleToHeight:1}},extend("CMP.AudioManager","CMP.DisplayObjectContainer"),CMP.Circle=function(a){this.construct(a),this.defineWithSetCallback("radius",this._radiusUpdated.bind(this)),this.radius&&(this.width=this.height=2*this.radius)},CMP.Circle.prototype={_updatedDimensions:function(){},_radiusUpdated:function(){this.radius&&!this.layout&&("number"==typeof this.registrationX&&(this.regX=2*this.radius*(this.registrationX-.5),"number"==typeof this._offsetRegX&&(this.regX+=this._offsetRegX)),"number"==typeof this.registrationY&&(this.regY=2*this.radius*(this.registrationY-.5),"number"==typeof this._offsetRegY&&(this.regY+=this._offsetRegY))),this._updateHitArea(this.radius),this._updateGraphics(this.radius)},addHitArea:function(a,b){var c="number"==typeof b?b:this.radius;this._updateHitArea(c),a="function"==typeof a?a:function(){},this.on("click",a)},_updateHitArea:function(a){this.hitArea=new createjs.Shape((new createjs.Graphics).beginFill("#fff").arc(0,0,a,0,2*Math.PI))},_updateGraphics:function(){this.backgroundColor&&this.graphics&&"number"==typeof this.radius&&(this.graphics.clear(),this.graphics.beginFill(this.backgroundColor).drawCircle(0,0,this.radius),this._updateWebGL())},_updateWebGL:function(){CMP.App.webGLEnabled&&(this.uncache(),this.cache(-this.radius,-this.radius,2*this.radius,2*this.radius))}},extend("CMP.Circle","CMP.DisplayObject"),function(){"use strict";var a=function(){this.init()};a.prototype={init:function(){var a=this||b;return a._counter=1e3,a._html5AudioPool=[],a.html5PoolSize=10,a._codecs={},a._howls=[],a._muted=!1,a._volume=1,a._canPlayEvent="canplaythrough",a._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,a.masterGain=null,a.noAudio=!1,a.usingWebAudio=!0,a.autoSuspend=!0,a.ctx=null,a.autoUnlock=!0,a._setup(),a},volume:function(a){var c=this||b;if(a=parseFloat(a),c.ctx||j(),void 0!==a&&a>=0&&a<=1){if(c._volume=a,c._muted)return c;c.usingWebAudio&&c.masterGain.gain.setValueAtTime(a,b.ctx.currentTime);for(var d=0;d<c._howls.length;d++)if(!c._howls[d]._webAudio)for(var e=c._howls[d]._getSoundIds(),f=0;f<e.length;f++){var g=c._howls[d]._soundById(e[f]);g&&g._node&&(g._node.volume=g._volume*a)}return c}return c._volume},mute:function(a){var c=this||b;c.ctx||j(),c._muted=a,c.usingWebAudio&&c.masterGain.gain.setValueAtTime(a?0:c._volume,b.ctx.currentTime);for(var d=0;d<c._howls.length;d++)if(!c._howls[d]._webAudio)for(var e=c._howls[d]._getSoundIds(),f=0;f<e.length;f++){var g=c._howls[d]._soundById(e[f]);g&&g._node&&(g._node.muted=!!a||g._muted)}return c},stop:function(){for(var a=this||b,c=0;c<a._howls.length;c++)a._howls[c].stop();return a},unload:function(){for(var a=this||b,c=a._howls.length-1;c>=0;c--)a._howls[c].unload();return a.usingWebAudio&&a.ctx&&void 0!==a.ctx.close&&(a.ctx.close(),a.ctx=null,j()),a},codecs:function(a){return(this||b)._codecs[a.replace(/^x-/,"")]},_setup:function(){var a=this||b;if(a.state=a.ctx?a.ctx.state||"suspended":"suspended",a._autoSuspend(),!a.usingWebAudio)if("undefined"!=typeof Audio)try{var c=new Audio;void 0===c.oncanplaythrough&&(a._canPlayEvent="canplay")}catch(b){a.noAudio=!0}else a.noAudio=!0;try{var c=new Audio;c.muted&&(a.noAudio=!0)}catch(a){}return a.noAudio||a._setupCodecs(),a},_setupCodecs:function(){var a=this||b,c=null;try{c="undefined"!=typeof Audio?new Audio:null}catch(b){return a}if(!c||"function"!=typeof c.canPlayType)return a;var d=c.canPlayType("audio/mpeg;").replace(/^no$/,""),e=a._navigator&&a._navigator.userAgent.match(/OPR\/([0-6].)/g),f=e&&parseInt(e[0].split("/")[1],10)<33;return a._codecs={mp3:!(f||!d&&!c.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!d,opus:!!c.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(c.canPlayType('audio/wav; codecs="1"')||c.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!c.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!c.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(c.canPlayType("audio/x-m4a;")||c.canPlayType("audio/m4a;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(c.canPlayType("audio/x-m4b;")||c.canPlayType("audio/m4b;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(c.canPlayType("audio/x-mp4;")||c.canPlayType("audio/mp4;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!c.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!c.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!c.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(c.canPlayType("audio/x-flac;")||c.canPlayType("audio/flac;")).replace(/^no$/,"")},a},_unlockAudio:function(){var a=this||b;if(!a._audioUnlocked&&a.ctx){a._audioUnlocked=!1,a.autoUnlock=!1,a._mobileUnloaded||44100===a.ctx.sampleRate||(a._mobileUnloaded=!0,a.unload()),a._scratchBuffer=a.ctx.createBuffer(1,1,22050);var c=function b(c){for(;a._html5AudioPool.length<a.html5PoolSize;)try{var d=new Audio;d._unlocked=!0,a._releaseHtml5Audio(d)}catch(c){a.noAudio=!0;break}for(var e=0;e<a._howls.length;e++)if(!a._howls[e]._webAudio)for(var f=a._howls[e]._getSoundIds(),g=0;g<f.length;g++){var h=a._howls[e]._soundById(f[g]);h&&h._node&&!h._node._unlocked&&(h._node._unlocked=!0,h._node.load())}a._autoResume();var i=a.ctx.createBufferSource();i.buffer=a._scratchBuffer,i.connect(a.ctx.destination),void 0===i.start?i.noteOn(0):i.start(0),"function"==typeof a.ctx.resume&&a.ctx.resume(),i.onended=function(){i.disconnect(0),a._audioUnlocked=!0,document.removeEventListener("touchstart",b,!0),document.removeEventListener("touchend",b,!0),document.removeEventListener("click",b,!0);for(var c=0;c<a._howls.length;c++)a._howls[c]._emit("unlock")}};return document.addEventListener("touchstart",c,!0),document.addEventListener("touchend",c,!0),document.addEventListener("click",c,!0),a}},_obtainHtml5Audio:function(){var a=this||b;if(a._html5AudioPool.length)return a._html5AudioPool.pop();var c=(new Audio).play();return c&&"undefined"!=typeof Promise&&(c instanceof Promise||"function"==typeof c.then)&&c.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(a){var c=this||b;return a._unlocked&&c._html5AudioPool.push(a),c},_autoSuspend:function(){var a=this;if(a.autoSuspend&&a.ctx&&void 0!==a.ctx.suspend&&b.usingWebAudio){for(var c=0;c<a._howls.length;c++)if(a._howls[c]._webAudio)for(var d=0;d<a._howls[c]._sounds.length;d++)if(!a._howls[c]._sounds[d]._paused)return a;return a._suspendTimer&&clearTimeout(a._suspendTimer),a._suspendTimer=setTimeout(function(){if(a.autoSuspend){a._suspendTimer=null,a.state="suspending";var b=function(){a.state="suspended",a._resumeAfterSuspend&&(delete a._resumeAfterSuspend,a._autoResume())};a.ctx.suspend().then(b,b)}},3e4),a}},_autoResume:function(){var a=this;if(a.ctx&&void 0!==a.ctx.resume&&b.usingWebAudio)return"running"===a.state&&"interrupted"!==a.ctx.state&&a._suspendTimer?(clearTimeout(a._suspendTimer),a._suspendTimer=null):"suspended"===a.state||"running"===a.state&&"interrupted"===a.ctx.state?(a.ctx.resume().then(function(){a.state="running";for(var b=0;b<a._howls.length;b++)a._howls[b]._emit("resume")}),a._suspendTimer&&(clearTimeout(a._suspendTimer),a._suspendTimer=null)):"suspending"===a.state&&(a._resumeAfterSuspend=!0),a}};var b=new a,c=function(a){var b=this;if(!a.src||0===a.src.length)return void console.error("An array of source files must be passed with any new Howl.");b.init(a)};c.prototype={init:function(a){var c=this;return b.ctx||j(),c._autoplay=a.autoplay||!1,c._format="string"!=typeof a.format?a.format:[a.format],c._html5=a.html5||!1,c._muted=a.mute||!1,c._loop=a.loop||!1,c._pool=a.pool||5,c._preload="boolean"!=typeof a.preload&&"metadata"!==a.preload||a.preload,c._rate=a.rate||1,c._sprite=a.sprite||{},c._src="string"!=typeof a.src?a.src:[a.src],c._volume=void 0!==a.volume?a.volume:1,c._xhr={method:a.xhr&&a.xhr.method?a.xhr.method:"GET",headers:a.xhr&&a.xhr.headers?a.xhr.headers:null,withCredentials:!(!a.xhr||!a.xhr.withCredentials)&&a.xhr.withCredentials},c._duration=0,c._state="unloaded",c._sounds=[],c._endTimers={},c._queue=[],c._playLock=!1,c._onend=a.onend?[{fn:a.onend}]:[],c._onfade=a.onfade?[{fn:a.onfade}]:[],c._onload=a.onload?[{fn:a.onload}]:[],c._onloaderror=a.onloaderror?[{fn:a.onloaderror}]:[],c._onplayerror=a.onplayerror?[{fn:a.onplayerror}]:[],c._onpause=a.onpause?[{fn:a.onpause}]:[],c._onplay=a.onplay?[{fn:a.onplay}]:[],c._onstop=a.onstop?[{fn:a.onstop}]:[],c._onmute=a.onmute?[{fn:a.onmute}]:[],c._onvolume=a.onvolume?[{fn:a.onvolume}]:[],c._onrate=a.onrate?[{fn:a.onrate}]:[],c._onseek=a.onseek?[{fn:a.onseek}]:[],c._onunlock=a.onunlock?[{fn:a.onunlock}]:[],c._onresume=[],c._webAudio=b.usingWebAudio&&!c._html5,void 0!==b.ctx&&b.ctx&&b.autoUnlock&&b._unlockAudio(),b._howls.push(c),c._autoplay&&c._queue.push({event:"play",action:function(){c.play()}}),c._preload&&"none"!==c._preload&&c.load(),c},load:function(){var a=this,c=null;if(b.noAudio)return void a._emit("loaderror",null,"No audio support.");"string"==typeof a._src&&(a._src=[a._src]);for(var e=0;e<a._src.length;e++){var g,h;if(a._format&&a._format[e])g=a._format[e];else{if("string"!=typeof(h=a._src[e])){a._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}g=/^data:audio\/([^;,]+);/i.exec(h),g||(g=/\.([^.]+)$/.exec(h.split("?",1)[0])),g&&(g=g[1].toLowerCase())}if(g||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),g&&b.codecs(g)){c=a._src[e];break}}return c?(a._src=c,a._state="loading","https:"===window.location.protocol&&"http:"===c.slice(0,5)&&(a._html5=!0,a._webAudio=!1),new d(a),a._webAudio&&f(a),a):void a._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(a,c){var d=this,e=null;if("number"==typeof a)e=a,a=null;else{if("string"==typeof a&&"loaded"===d._state&&!d._sprite[a])return null;if(void 0===a&&(a="__default",!d._playLock)){for(var f=0,g=0;g<d._sounds.length;g++)d._sounds[g]._paused&&!d._sounds[g]._ended&&(f++,e=d._sounds[g]._id);1===f?a=null:e=null}}var h=e?d._soundById(e):d._inactiveSound();if(!h)return null;if(e&&!a&&(a=h._sprite||"__default"),"loaded"!==d._state){h._sprite=a,h._ended=!1;var i=h._id;return d._queue.push({event:"play",action:function(){d.play(i)}}),i}if(e&&!h._paused)return c||d._loadQueue("play"),h._id;d._webAudio&&b._autoResume();var j=Math.max(0,h._seek>0?h._seek:d._sprite[a][0]/1e3),k=Math.max(0,(d._sprite[a][0]+d._sprite[a][1])/1e3-j),l=1e3*k/Math.abs(h._rate),m=d._sprite[a][0]/1e3,n=(d._sprite[a][0]+d._sprite[a][1])/1e3;h._sprite=a,h._ended=!1;var o=function(){h._paused=!1,h._seek=j,h._start=m,h._stop=n,h._loop=!(!h._loop&&!d._sprite[a][2])};if(j>=n)return void d._ended(h);var p=h._node;if(d._webAudio){var q=function(){d._playLock=!1,o(),d._refreshBuffer(h);var a=h._muted||d._muted?0:h._volume;p.gain.setValueAtTime(a,b.ctx.currentTime),h._playStart=b.ctx.currentTime,void 0===p.bufferSource.start?h._loop?p.bufferSource.noteGrainOn(0,j,86400):p.bufferSource.noteGrainOn(0,j,k):h._loop?p.bufferSource.start(0,j,86400):p.bufferSource.start(0,j,k),l!==1/0&&(d._endTimers[h._id]=setTimeout(d._ended.bind(d,h),l)),c||setTimeout(function(){d._emit("play",h._id),d._loadQueue()},0)};"running"===b.state&&"interrupted"!==b.ctx.state?q():(d._playLock=!0,d.once("resume",q),d._clearTimer(h._id))}else{var r=function(){p.currentTime=j,p.muted=h._muted||d._muted||b._muted||p.muted,p.volume=h._volume*b.volume(),p.playbackRate=h._rate;try{var e=p.play();if(e&&"undefined"!=typeof Promise&&(e instanceof Promise||"function"==typeof e.then)?(d._playLock=!0,o(),e.then(function(){d._playLock=!1,p._unlocked=!0,c||(d._emit("play",h._id),d._loadQueue())}).catch(function(){d._playLock=!1,d._emit("playerror",h._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),h._ended=!0,h._paused=!0})):c||(d._playLock=!1,o(),d._emit("play",h._id),d._loadQueue()),p.playbackRate=h._rate,p.paused)return void d._emit("playerror",h._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==a||h._loop?d._endTimers[h._id]=setTimeout(d._ended.bind(d,h),l):(d._endTimers[h._id]=function(){d._ended(h),p.removeEventListener("ended",d._endTimers[h._id],!1)},p.addEventListener("ended",d._endTimers[h._id],!1))}catch(a){d._emit("playerror",h._id,a)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===p.src&&(p.src=d._src,p.load());var s=window&&window.ejecta||!p.readyState&&b._navigator.isCocoonJS;if(p.readyState>=3||s)r();else{d._playLock=!0;var t=function a(){r(),p.removeEventListener(b._canPlayEvent,a,!1)};p.addEventListener(b._canPlayEvent,t,!1),d._clearTimer(h._id)}}return h._id},pause:function(a){var b=this;if("loaded"!==b._state||b._playLock)return b._queue.push({event:"pause",action:function(){b.pause(a)}}),b;for(var c=b._getSoundIds(a),d=0;d<c.length;d++){b._clearTimer(c[d]);var e=b._soundById(c[d]);if(e&&!e._paused&&(e._seek=b.seek(c[d]),e._rateSeek=0,e._paused=!0,b._stopFade(c[d]),e._node))if(b._webAudio){if(!e._node.bufferSource)continue;void 0===e._node.bufferSource.stop?e._node.bufferSource.noteOff(0):e._node.bufferSource.stop(0),b._cleanBuffer(e._node)}else isNaN(e._node.duration)&&e._node.duration!==1/0||e._node.pause();arguments[1]||b._emit("pause",e?e._id:null)}return b},stop:function(a,b){var c=this;if("loaded"!==c._state||c._playLock)return c._queue.push({event:"stop",action:function(){c.stop(a)}}),c;for(var d=c._getSoundIds(a),e=0;e<d.length;e++){c._clearTimer(d[e]);var f=c._soundById(d[e]);f&&(f._seek=f._start||0,f._rateSeek=0,f._paused=!0,f._ended=!0,c._stopFade(d[e]),f._node&&(c._webAudio?f._node.bufferSource&&(void 0===f._node.bufferSource.stop?f._node.bufferSource.noteOff(0):f._node.bufferSource.stop(0),c._cleanBuffer(f._node)):isNaN(f._node.duration)&&f._node.duration!==1/0||(f._node.currentTime=f._start||0,f._node.pause(),f._node.duration===1/0&&c._clearSound(f._node))),b||c._emit("stop",f._id))}return c},mute:function(a,c){var d=this;if("loaded"!==d._state||d._playLock)return d._queue.push({event:"mute",action:function(){d.mute(a,c)}}),d;if(void 0===c){if("boolean"!=typeof a)return d._muted;d._muted=a}for(var e=d._getSoundIds(c),f=0;f<e.length;f++){var g=d._soundById(e[f]);g&&(g._muted=a,g._interval&&d._stopFade(g._id),d._webAudio&&g._node?g._node.gain.setValueAtTime(a?0:g._volume,b.ctx.currentTime):g._node&&(g._node.muted=!!b._muted||a),d._emit("mute",g._id))}return d},volume:function(){var a,c,d=this,e=arguments;if(0===e.length)return d._volume;if(1===e.length||2===e.length&&void 0===e[1]){d._getSoundIds().indexOf(e[0])>=0?c=parseInt(e[0],10):a=parseFloat(e[0])}else e.length>=2&&(a=parseFloat(e[0]),c=parseInt(e[1],10));var f;if(!(void 0!==a&&a>=0&&a<=1))return f=c?d._soundById(c):d._sounds[0],f?f._volume:0;if("loaded"!==d._state||d._playLock)return d._queue.push({event:"volume",action:function(){d.volume.apply(d,e)}}),d;void 0===c&&(d._volume=a),c=d._getSoundIds(c);for(var g=0;g<c.length;g++)(f=d._soundById(c[g]))&&(f._volume=a,e[2]||d._stopFade(c[g]),d._webAudio&&f._node&&!f._muted?f._node.gain.setValueAtTime(a,b.ctx.currentTime):f._node&&!f._muted&&(f._node.volume=a*b.volume()),d._emit("volume",f._id));return d},fade:function(a,c,d,e){var f=this;if("loaded"!==f._state||f._playLock)return f._queue.push({event:"fade",action:function(){f.fade(a,c,d,e)}}),f;a=Math.min(Math.max(0,parseFloat(a)),1),c=Math.min(Math.max(0,parseFloat(c)),1),d=parseFloat(d),f.volume(a,e);for(var g=f._getSoundIds(e),h=0;h<g.length;h++){var i=f._soundById(g[h]);if(i){if(e||f._stopFade(g[h]),f._webAudio&&!i._muted){var j=b.ctx.currentTime,k=j+d/1e3;i._volume=a,i._node.gain.setValueAtTime(a,j),i._node.gain.linearRampToValueAtTime(c,k)}f._startFadeInterval(i,a,c,d,g[h],void 0===e)}}return f},_startFadeInterval:function(a,b,c,d,e,f){var g=this,h=b,i=c-b,j=Math.abs(i/.01),k=Math.max(4,j>0?d/j:d),l=Date.now();a._fadeTo=c,a._interval=setInterval(function(){var e=(Date.now()-l)/d;l=Date.now(),h+=i*e,h=Math.round(100*h)/100,h=i<0?Math.max(c,h):Math.min(c,h),g._webAudio?a._volume=h:g.volume(h,a._id,!0),f&&(g._volume=h),(c<b&&h<=c||c>b&&h>=c)&&(clearInterval(a._interval),a._interval=null,a._fadeTo=null,g.volume(c,a._id),g._emit("fade",a._id))},k)},_stopFade:function(a){var c=this,d=c._soundById(a);return d&&d._interval&&(c._webAudio&&d._node.gain.cancelScheduledValues(b.ctx.currentTime),clearInterval(d._interval),d._interval=null,c.volume(d._fadeTo,a),d._fadeTo=null,c._emit("fade",a)),c},loop:function(){var a,b,c,d=this,e=arguments;if(0===e.length)return d._loop;if(1===e.length){if("boolean"!=typeof e[0])return!!(c=d._soundById(parseInt(e[0],10)))&&c._loop;a=e[0],d._loop=a}else 2===e.length&&(a=e[0],b=parseInt(e[1],10));for(var f=d._getSoundIds(b),g=0;g<f.length;g++)(c=d._soundById(f[g]))&&(c._loop=a,d._webAudio&&c._node&&c._node.bufferSource&&(c._node.bufferSource.loop=a,a&&(c._node.bufferSource.loopStart=c._start||0,c._node.bufferSource.loopEnd=c._stop)));return d},rate:function(){var a,c,d=this,e=arguments;if(0===e.length)c=d._sounds[0]._id;else if(1===e.length){var f=d._getSoundIds(),g=f.indexOf(e[0]);g>=0?c=parseInt(e[0],10):a=parseFloat(e[0])}else 2===e.length&&(a=parseFloat(e[0]),c=parseInt(e[1],10));var h;if("number"!=typeof a)return h=d._soundById(c),h?h._rate:d._rate;if("loaded"!==d._state||d._playLock)return d._queue.push({event:"rate",action:function(){d.rate.apply(d,e)}}),d;void 0===c&&(d._rate=a),c=d._getSoundIds(c);for(var i=0;i<c.length;i++)if(h=d._soundById(c[i])){d.playing(c[i])&&(h._rateSeek=d.seek(c[i]),h._playStart=d._webAudio?b.ctx.currentTime:h._playStart),h._rate=a,d._webAudio&&h._node&&h._node.bufferSource?h._node.bufferSource.playbackRate.setValueAtTime(a,b.ctx.currentTime):h._node&&(h._node.playbackRate=a);var j=d.seek(c[i]),k=(d._sprite[h._sprite][0]+d._sprite[h._sprite][1])/1e3-j,l=1e3*k/Math.abs(h._rate);!d._endTimers[c[i]]&&h._paused||(d._clearTimer(c[i]),d._endTimers[c[i]]=setTimeout(d._ended.bind(d,h),l)),d._emit("rate",h._id)}return d},seek:function(){var a,c,d=this,e=arguments;if(0===e.length)c=d._sounds[0]._id;else if(1===e.length){var f=d._getSoundIds(),g=f.indexOf(e[0]);g>=0?c=parseInt(e[0],10):d._sounds.length&&(c=d._sounds[0]._id,a=parseFloat(e[0]))}else 2===e.length&&(a=parseFloat(e[0]),c=parseInt(e[1],10));if(void 0===c)return d;if("number"==typeof a&&("loaded"!==d._state||d._playLock))return d._queue.push({event:"seek",action:function(){d.seek.apply(d,e)}}),d;var h=d._soundById(c);if(h){if(!("number"==typeof a&&a>=0)){if(d._webAudio){var i=d.playing(c)?b.ctx.currentTime-h._playStart:0,j=h._rateSeek?h._rateSeek-h._seek:0;return h._seek+(j+i*Math.abs(h._rate))}return h._node.currentTime}var k=d.playing(c);k&&d.pause(c,!0),h._seek=a,h._ended=!1,d._clearTimer(c),d._webAudio||!h._node||isNaN(h._node.duration)||(h._node.currentTime=a);var l=function(){d._emit("seek",c),k&&d.play(c,!0)};if(k&&!d._webAudio){var m=function a(){d._playLock?setTimeout(a,0):l()};setTimeout(m,0)}else l()}return d},playing:function(a){var b=this;if("number"==typeof a){var c=b._soundById(a);return!!c&&!c._paused}for(var d=0;d<b._sounds.length;d++)if(!b._sounds[d]._paused)return!0;return!1},duration:function(a){var b=this,c=b._duration,d=b._soundById(a);return d&&(c=b._sprite[d._sprite][1]/1e3),c},state:function(){return this._state},unload:function(){for(var a=this,c=a._sounds,d=0;d<c.length;d++)c[d]._paused||a.stop(c[d]._id),a._webAudio||(a._clearSound(c[d]._node),c[d]._node.removeEventListener("error",c[d]._errorFn,!1),c[d]._node.removeEventListener(b._canPlayEvent,c[d]._loadFn,!1),c[d]._node.removeEventListener("ended",c[d]._endFn,!1),b._releaseHtml5Audio(c[d]._node)),delete c[d]._node,a._clearTimer(c[d]._id);var f=b._howls.indexOf(a);f>=0&&b._howls.splice(f,1);var g=!0;for(d=0;d<b._howls.length;d++)if(b._howls[d]._src===a._src||a._src.indexOf(b._howls[d]._src)>=0){g=!1;break}return e&&g&&delete e[a._src],b.noAudio=!1,a._state="unloaded",a._sounds=[],a=null,null},on:function(a,b,c,d){var e=this,f=e["_on"+a];return"function"==typeof b&&f.push(d?{id:c,fn:b,once:d}:{id:c,fn:b}),e},off:function(a,b,c){var d=this,e=d["_on"+a],f=0;if("number"==typeof b&&(c=b,b=null),b||c)for(f=0;f<e.length;f++){var g=c===e[f].id;if(b===e[f].fn&&g||!b&&g){e.splice(f,1);break}}else if(a)d["_on"+a]=[];else{var h=Object.keys(d);for(f=0;f<h.length;f++)0===h[f].indexOf("_on")&&Array.isArray(d[h[f]])&&(d[h[f]]=[])}return d},once:function(a,b,c){var d=this;return d.on(a,b,c,1),d},_emit:function(a,b,c){for(var d=this,e=d["_on"+a],f=e.length-1;f>=0;f--)e[f].id&&e[f].id!==b&&"load"!==a||(setTimeout(function(a){a.call(this,b,c)}.bind(d,e[f].fn),0),e[f].once&&d.off(a,e[f].fn,e[f].id));return d._loadQueue(a),d},_loadQueue:function(a){var b=this;if(b._queue.length>0){var c=b._queue[0];c.event===a&&(b._queue.shift(),b._loadQueue()),a||c.action()}return b},_ended:function(a){var c=this,d=a._sprite;if(!c._webAudio&&a._node&&!a._node.paused&&!a._node.ended&&a._node.currentTime<a._stop)return setTimeout(c._ended.bind(c,a),100),c;var e=!(!a._loop&&!c._sprite[d][2]);if(c._emit("end",a._id),!c._webAudio&&e&&c.stop(a._id,!0).play(a._id),c._webAudio&&e){c._emit("play",a._id),a._seek=a._start||0,a._rateSeek=0,a._playStart=b.ctx.currentTime;var f=1e3*(a._stop-a._start)/Math.abs(a._rate);c._endTimers[a._id]=setTimeout(c._ended.bind(c,a),f)}return c._webAudio&&!e&&(a._paused=!0,a._ended=!0,a._seek=a._start||0,a._rateSeek=0,c._clearTimer(a._id),c._cleanBuffer(a._node),b._autoSuspend()),c._webAudio||e||c.stop(a._id,!0),c},_clearTimer:function(a){var b=this;if(b._endTimers[a]){if("function"!=typeof b._endTimers[a])clearTimeout(b._endTimers[a]);else{var c=b._soundById(a);c&&c._node&&c._node.removeEventListener("ended",b._endTimers[a],!1)}delete b._endTimers[a]}return b},_soundById:function(a){for(var b=this,c=0;c<b._sounds.length;c++)if(a===b._sounds[c]._id)return b._sounds[c];return null},_inactiveSound:function(){var a=this;a._drain();for(var b=0;b<a._sounds.length;b++)if(a._sounds[b]._ended)return a._sounds[b].reset();return new d(a)},_drain:function(){var a=this,b=a._pool,c=0,d=0;if(!(a._sounds.length<b)){for(d=0;d<a._sounds.length;d++)a._sounds[d]._ended&&c++;for(d=a._sounds.length-1;d>=0;d--){if(c<=b)return;a._sounds[d]._ended&&(a._webAudio&&a._sounds[d]._node&&a._sounds[d]._node.disconnect(0),a._sounds.splice(d,1),c--)}}},_getSoundIds:function(a){var b=this;if(void 0===a){for(var c=[],d=0;d<b._sounds.length;d++)c.push(b._sounds[d]._id);return c}return[a]},_refreshBuffer:function(a){var c=this;return a._node.bufferSource=b.ctx.createBufferSource(),a._node.bufferSource.buffer=e[c._src],a._panner?a._node.bufferSource.connect(a._panner):a._node.bufferSource.connect(a._node),a._node.bufferSource.loop=a._loop,a._loop&&(a._node.bufferSource.loopStart=a._start||0,a._node.bufferSource.loopEnd=a._stop||0),a._node.bufferSource.playbackRate.setValueAtTime(a._rate,b.ctx.currentTime),c},_cleanBuffer:function(a){var c=this,d=b._navigator&&b._navigator.vendor.indexOf("Apple")>=0;if(b._scratchBuffer&&a.bufferSource&&(a.bufferSource.onended=null,a.bufferSource.disconnect(0),d))try{a.bufferSource.buffer=b._scratchBuffer}catch(a){}return a.bufferSource=null,c},_clearSound:function(a){/MSIE |Trident\//.test(b._navigator&&b._navigator.userAgent)||(a.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var d=function(a){this._parent=a,this.init()};d.prototype={init:function(){var a=this,c=a._parent;return a._muted=c._muted,a._loop=c._loop,a._volume=c._volume,a._rate=c._rate,a._seek=0,a._paused=!0,a._ended=!0,a._sprite="__default",a._id=++b._counter,c._sounds.push(a),a.create(),a},create:function(){var a=this,c=a._parent,d=b._muted||a._muted||a._parent._muted?0:a._volume;return c._webAudio?(a._node=void 0===b.ctx.createGain?b.ctx.createGainNode():b.ctx.createGain(),a._node.gain.setValueAtTime(d,b.ctx.currentTime),a._node.paused=!0,a._node.connect(b.masterGain)):b.noAudio||(a._node=b._obtainHtml5Audio(),a._errorFn=a._errorListener.bind(a),a._node.addEventListener("error",a._errorFn,!1),a._loadFn=a._loadListener.bind(a),a._node.addEventListener(b._canPlayEvent,a._loadFn,!1),a._endFn=a._endListener.bind(a),a._node.addEventListener("ended",a._endFn,!1),a._node.src=c._src,a._node.preload=!0===c._preload?"auto":c._preload,a._node.volume=d*b.volume(),a._node.load()),a},reset:function(){var a=this,c=a._parent;return a._muted=c._muted,a._loop=c._loop,a._volume=c._volume,a._rate=c._rate,a._seek=0,a._rateSeek=0,a._paused=!0,a._ended=!0,a._sprite="__default",a._id=++b._counter,a},_errorListener:function(){var a=this;a._parent._emit("loaderror",a._id,a._node.error?a._node.error.code:0),a._node.removeEventListener("error",a._errorFn,!1)},_loadListener:function(){var a=this,c=a._parent;c._duration=Math.ceil(10*a._node.duration)/10,0===Object.keys(c._sprite).length&&(c._sprite={__default:[0,1e3*c._duration]}),"loaded"!==c._state&&(c._state="loaded",c._emit("load"),c._loadQueue()),a._node.removeEventListener(b._canPlayEvent,a._loadFn,!1)},_endListener:function(){var a=this,b=a._parent;b._duration===1/0&&(b._duration=Math.ceil(10*a._node.duration)/10,b._sprite.__default[1]===1/0&&(b._sprite.__default[1]=1e3*b._duration),b._ended(a)),a._node.removeEventListener("ended",a._endFn,!1)}};var e={},f=function(a){var b=a._src;if(e[b])return a._duration=e[b].duration,void i(a);if(/^data:[^;]+;base64,/.test(b)){for(var c=atob(b.split(",")[1]),d=new Uint8Array(c.length),f=0;f<c.length;++f)d[f]=c.charCodeAt(f);h(d.buffer,a)}else{var j=new XMLHttpRequest;j.open(a._xhr.method,b,!0),j.withCredentials=a._xhr.withCredentials,j.responseType="arraybuffer",a._xhr.headers&&Object.keys(a._xhr.headers).forEach(function(b){j.setRequestHeader(b,a._xhr.headers[b])}),j.onload=function(){var b=(j.status+"")[0];if("0"!==b&&"2"!==b&&"3"!==b)return void a._emit("loaderror",null,"Failed loading audio file with status: "+j.status+".");h(j.response,a)},j.onerror=function(){a._webAudio&&(a._html5=!0,a._webAudio=!1,a._sounds=[],delete e[b],a.load())},g(j)}},g=function(a){try{a.send()}catch(b){a.onerror()}},h=function(a,c){var d=function(){c._emit("loaderror",null,"Decoding audio data failed.")},f=function(a){a&&c._sounds.length>0?(e[c._src]=a,i(c,a)):d()};"undefined"!=typeof Promise&&1===b.ctx.decodeAudioData.length?b.ctx.decodeAudioData(a).then(f).catch(d):b.ctx.decodeAudioData(a,f,d)},i=function(a,b){b&&!a._duration&&(a._duration=b.duration),0===Object.keys(a._sprite).length&&(a._sprite={__default:[0,1e3*a._duration]}),"loaded"!==a._state&&(a._state="loaded",a._emit("load"),a._loadQueue())},j=function(){if(b.usingWebAudio){try{"undefined"!=typeof AudioContext?b.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?b.ctx=new webkitAudioContext:b.usingWebAudio=!1}catch(a){b.usingWebAudio=!1}b.ctx||(b.usingWebAudio=!1);var a=/iP(hone|od|ad)/.test(b._navigator&&b._navigator.platform),c=b._navigator&&b._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),d=c?parseInt(c[1],10):null;if(a&&d&&d<9){var e=/safari/.test(b._navigator&&b._navigator.userAgent.toLowerCase());b._navigator&&!e&&(b.usingWebAudio=!1)}b.usingWebAudio&&(b.masterGain=void 0===b.ctx.createGain?b.ctx.createGainNode():b.ctx.createGain(),b.masterGain.gain.setValueAtTime(b._muted?0:b._volume,b.ctx.currentTime),b.masterGain.connect(b.ctx.destination)),b._setup()}};"function"==typeof define&&define.amd&&define([],function(){return{Howler:b,Howl:c}}),"undefined"!=typeof exports&&(exports.Howler=b,exports.Howl=c),"undefined"!=typeof global?(global.HowlerGlobal=a,global.Howler=b,global.Howl=c,global.Sound=d):"undefined"!=typeof window&&(window.HowlerGlobal=a,window.Howler=b,window.Howl=c,window.Sound=d)}(),CMP.Sprite=function(a){this._drawPercentX=this._drawPercentY=1,this._offsetPercentX=this._offsetPercentY=0,this.imageSet=[],a=void 0!==a?a:{},a.spritesheet||(a.spritesheet=CMP.App.GLOBALSPRITESHEET?CMP.App.GLOBALSPRITESHEET:void 0);var b=CMP.App.getImage(a.image);a.spritesheet?this.imageSet=a.spritesheet.images:(a.spritesheet=new CMP.SpriteBatch({images:[a.image]}),b&&this.imageSet.push(a.image)),this.x=this.y=this.width=this.height=0,this.construct(a),a&&(this.spritesheet&&this.initSprite(),this.setImage(a.image))},CMP.Sprite.prototype={defineSetters:function(){this.defineWithSetCallback("width",this._updatedDimensions.bind(this)),this.defineWithSetCallback("height",this._updatedDimensions.bind(this)),this.defineWithSetCallback("backgroundColor",this._updateBackground.bind(this)),this.defineWithSetCallback("parent",CMP.App.resizeTemplate.bind(this)),this.defineWithSetCallback("scale",this._setScale.bind(this)),this.defineWithSetCallback("blurFactor",this._setBlurFactor.bind(this))},_updatedDimensions:function(){!this.width||!this.height||this.layout&&"match"!==this.layout||("number"==typeof this.registrationX&&(this.regX=this.width*this.registrationX,"number"==typeof this._offsetRegX&&(this.regX+=this._offsetRegX)),"number"==typeof this.registrationY&&(this.regY=this.height*this.registrationY,"number"==typeof this._offsetRegY&&(this.regY+=this._offsetRegY))),this.spriteContainer&&this._updateHitArea(this.spriteContainer.width,this.spriteContainer.height),this._updateBackground()},_setBlurFactor:function(){"number"==typeof this.blurFactor&&(this.blurFactorX=this.blurFactor,this.blurFactorY=this.blurFactor)},addHitArea:function(a,b,c){this.removeHitArea();var d="number"==typeof b?b:this.spriteContainer.width,e="number"==typeof c?c:this.spriteContainer.height;this.spriteContainer.hitArea=new createjs.Shape((new createjs.Graphics).beginFill("#fff").drawRect(0,0,d,e)),a="function"==typeof a?a:function(){},this.spriteContainer._hitAreaListener=this.spriteContainer.on("click",a)},removeHitArea:function(){this.spriteContainer._hitAreaListener&&(this.spriteContainer.off("click",this._hitAreaListener),this.spriteContainer.hitArea=!1)},_updateHitArea:function(a,b,c){this.spriteContainer.hitArea="number"==typeof c?new createjs.Shape((new createjs.Graphics).beginFill("#fff").drawRoundRect(0,0,a,b,c)):new createjs.Shape((new createjs.Graphics).beginFill("#fff").drawRect(0,0,a,b))},initSprite:function(){var a=CMP.App.getImage(this.image);this.spriteContainer&&(this.spriteContainer.markForRemoval(),this.parent&&this.parent.removeChild(this.spriteContainer)),this.spriteContainer=this.addChild(new CMP.DisplayObjectContainer({width:this.width,height:this.height,x:this.percentageOfWidth(.5),y:this.percentageOfHeight(.5)})),this.sprite=this.spriteContainer.addChild(new createjs.Sprite(this.spritesheet)),this.spriteContainer.visible=!!a,a&&(this.sprite.stop(),this.width&&this.height||(this.width=a.width,this.height=a.height)),this.sprite.x=this.spriteContainer.percentageOfWidth(.5),this.sprite.y=this.spriteContainer.percentageOfHeight(.5)},setImage:function(a){var b=CMP.App.getImage(a);if(this.spritesheet){if(!b&&!this.spritesheet.doesAnimationExist(a))return;this.image=this._image=a,this.spritesheet.doesAnimationExist(a)?this.spriteContainer||this.initSprite():(this.imageSet.push(a),this.spritesheet=new CMP.SpriteBatch({images:this.imageSet}),this.initSprite()),this.sprite&&this.changeFrameTo(a),this.blurred&&this._blurCurrentImg(),this._mDrawImg();var c=this.sprite.currentFrame,d=this.spritesheet._frames[c];return void(this.img=d.image)}},changeFrameTo:function(a){if(this.spritesheet.doesAnimationExist(a)){isNaN(a)?this.sprite.gotoAndStop(a):this.sprite.gotoAndStop(parseInt(a));var b=this.spritesheet.getAnimationData(a);this.width=b._frameWidth,this.height=b._frameHeight,this.sprite.width=b._frameWidth,this.sprite.height=b._frameHeight,this.spriteContainer.visible=!0,"function"==typeof this._resize&&this._resize()}},_blurCurrentImg:function(){this._blurCurrentImgWebGL()},_blurCurrentImgWebGL:function(){var a="number"==typeof this.blurFactorX?this.blurFactorX:.02,b="number"==typeof this.blurFactorY?this.blurFactorY:.02,c="number"==typeof this.blurIterations?this.blurIterations:1;this.blurFilter=new createjs.BlurFilter(a*this.spriteContainer.width,b*this.spriteContainer.height,c),this.sprite.filters=[this.blurFilter];var d=this.sprite.getBounds(),e=this.blurFilter.getBounds();if(void 0===e&&(e={x:0,y:0,width:0,height:0}),this.sprite.cache(d.x+e.x,d.y+e.y,d.width+e.width,d.height+e.height),CMP.App.webGLEnabled)try{this.spriteContainer.updateCache()}catch(a){}},_unblur:function(){this.sprite&&(this.sprite.filters=[],this.sprite.uncache(),this._mDrawImg())},_mDrawImg:function(a){if(this.spriteContainer){if(this.spriteContainer.width=this.sprite.width,this.spriteContainer.height=this.sprite.height,this.regX=this.spriteContainer.width*this.registrationX,this.regY=this.spriteContainer.height*this.registrationY,this.spriteContainer.x=this.width/2,this.spriteContainer.y=this.height/2,this.sprite.x=this.spriteContainer.percentageOfWidth(.5),this.sprite.y=this.spriteContainer.percentageOfHeight(.5),!this.sprite._animation||!this.sprite._animation||!this.spriteContainer.visible)return;var b={width:this.sprite._animation._frameWidth*this.sprite.scale,height:this.sprite._animation._frameHeight*this.sprite.scale},c=Math.min(this._drawPercentX,this._offsetPercentX),d=Math.max(this._drawPercentX,this._offsetPercentX),e=Math.min(this._drawPercentY,this._offsetPercentY),f=Math.max(this._drawPercentY,this._offsetPercentY),g=b.width*c,h=b.width*(d-c),i=b.height*e,j=b.height*(f-e);return this.sprite.mask||(this.sprite.mask=new createjs.Shape),this.sprite.mask.graphics.clear(),this.sprite.mask.graphics.drawRect(g,i,h,j),this.spriteContainer.uncache(),void(CMP.App.webGLEnabled&&this.sprite.mask&&(a||this.spriteContainer.cache(g,i,h,j)))}},getImgObj:function(){return this.img}},extend("CMP.Sprite","CMP.DisplayObjectContainer"),CMP.SizedSprite=function(a){this.construct(a),this.sprite=this.addChild(new CMP.Sprite({spritesheet:a.spritesheet,image:a.image,layout:{xPercentage:.5,yPercentage:.5,scaleToWidth:1,scaleToHeight:1}})),a.image&&this.setImage(a.image)},CMP.SizedSprite.prototype={setImage:function(a){this.sprite.setImage(a)},getImgObj:function(){return this.sprite.getImgObj()}},extend("CMP.SizedSprite","CMP.DisplayObjectContainer"),CMP.SpriteSheet=function(a){this._currentFrame=0,this._playing="boolean"==typeof this._playing&&this._playing,this.loop="boolean"!=typeof this.loop?1:this.loop,this.rows="number"!=typeof this.rows?1:this.rows,this.columns="number"!=typeof this.columns?1:this.columns,this.fps="number"!=typeof this.fps?24:this.fps,this.removeOnEnd="boolean"==typeof this.removeOnEnd&&this.removeOnEnd,this.construct(a),this._drawFrame(),this._updateFrames=this._updateFrames.bind(this),this._frameTime="number"==typeof a.delay?-a.delay:0,CMP.App.addUpdate(this._updateFrames.bind(this))},CMP.SpriteSheet.prototype={_drawFrame:function(){if("string"==typeof this._image&&"number"==typeof this._currentFrame){var a=this._currentFrame%(this.rows*this.columns);this.img&&this.img.complete&&(this.graphics.clear(),this.width&&this.height||(this.width=this.img.width/this.columns,this.height=this.img.height/this.rows,"function"==typeof this._resize&&this._resize()),this._offsetRegX=this.width*(a%this.columns),this._offsetRegY=this.height*Math.floor(a/this.columns),this.regX=this.width*this.registrationX+this._offsetRegX,this.regY=this.height*this.registrationY+this._offsetRegY,this.graphics.beginBitmapFill(this.img).drawRect(this._offsetRegX,this._offsetRegY,this.width,this.height))}},_updateFrames:function(a){var b=a.delta;if(this._markedForRemoval)return void CMP.App.removeUpdate(this._updateFrames);this._playing&&(this._frameTime+=b/1e3);for(var c=this._currentFrame;this._frameTime>1/this.fps;)this._frameTime-=1/this.fps,this._currentFrame++,this._currentFrame>=this.rows*this.columns&&!this.loop&&(this._currentFrame--,this._playing=!1,this.removeOnEnd&&this.markForRemoval()),this._currentFrame=this._currentFrame%(this.rows*this.columns);c!==this._currentFrame&&this._drawFrame()},play:function(){this._playing=!0},playFromStart:function(){this._frameTime=0,this._currentFrame=0,this._playing=!0},playAndRemove:function(){this._playing=!0,this.removeOnEnd=!0,this.loop=!1},setImage:function(a){"string"==typeof a&&(this._image==a&&this.img||(this._image=a,this.img=CMP.App.getImage(a),this.img&&this.img.complete&&(this.width=this.img.width/this.columns,this.height=this.img.height/this.rows,"function"==typeof this._resize&&this._resize())),this._drawFrame())},setAnimation:function(a){a&&"string"==typeof a.image&&(this._currentFrame=0,Object.assign(this,a),this.setImage(a.image))}},extend("CMP.SpriteSheet","CMP.Sprite");var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};CMP.SpriteBatch=function(a){try{if(!a.hasOwnProperty("images"))throw"images";var b=this._initializeImageData(a);this.initializationData=b,this.images=a.images,this.construct(b),this.init()}catch(a){console.error("Must specify",a,"property")}},CMP.SpriteBatch.prototype={init:function(){CMP.Listen("ImageReplaced",this.onImageReplaced.bind(this))},sortImageSet:function(a){if(!a||!a.length)return[];for(var b=[],c=[],d=0;d<=a.length;d++){var e=a[d];isNaN(e)?c.push(e):b.push(e)}return b.sort(function(a,b){return parseInt(a)>parseInt(b)?1:-1}),b.concat(c)},onImageReplaced:function(a){var b=a.data,c=this.getAnimation(b.id);if(c){var d=b.image.img;c._frameHeight=d.height,c._frameWidth=d.width;var e=c.frames[0];this._frames[e].image=d,this._frames[e].rect=new createjs.Rectangle(0,0,d.width,d.height),this._frames[e].regX=d.width/2,this._frames[e].regY=d.height/2}},_initializeImageData:function(a){if("object"==(void 0===a?"undefined":_typeof(a))){var b=this._animations?this._animations.length:0,c={},d=a.images,e=!a.hasOwnProperty("frames");c.frames=e?[]:a.frames;var f=!a.hasOwnProperty("animations");c.animations=e?{}:a.animations,a.frames||a.animations||(d=this.sortImageSet(d)),c.images=[];for(var g=0;g<d.length;g++)if("string"==typeof d[g]){var h=CMP.App.getImage(d[g]);if(!h)continue;if(this.initializationData&&this.initializationData.images.includes(h))continue;c.images.push(h),e&&c.frames.push([0,0,h.width,h.height,b,h.width/2,h.height/2]),f&&(c.animations[d[g]]=b),b++}return c}},addImagesToBatch:function(a){var b=this._initializeImageData(a);if(b){for(var c=0;c<b.images.length;c++){var d=b.images[c];this.initializationData.images.push(d),this.initializationData.frames.push(b.frames[c])}Object.assign(this.initializationData.animations,b.animations),this._parseData(this.initializationData)}},getAnimationData:function(a){var b=this._data[a];return b&&(b._frameHeight=this._frames[b.frames[0]].rect.height,b._frameWidth=this._frames[b.frames[0]].rect.width),b},doesAnimationExist:function(a){return!!this.getAnimationData(a)}},extend("CMP.SpriteBatch","SpriteSheet"),CMP.Window=function(a){this.construct(a),CMP.App.stage.addChild(this)},CMP.Window.prototype={backgroundColor:"#000",x:0,y:0,registrationX:0,registrationY:0,width:500,height:500,layout:"match",inWindow:!0},extend("CMP.Window","CMP.DisplayObjectContainer"),CMP.Overlay=function(a){this.construct(a),CMP.App.stage.addChild(this),Object.assign(this,{x:0,y:0,registrationX:0,registrationY:0,width:500,height:500,layout:"match",inWindow:!0}),this._resize();var b=this.addChild(new CMP.DisplayObject({backgroundColor:"#fff",alpha:.5,x:0,y:0,registrationX:0,registrationY:0,width:500,height:500,layout:"match",inWindow:!0}));b._resize(),b.on("mousedown",this.blockInput.bind(this));var c=this.addChild(new CMP.DisplayObjectContainer({width:500,height:500,alpha:.5,layout:{xPercentage:.5,yPercentage:.5,scaleToWidth:.3,scaleToHeight:.3}}));this.circles=[];for(var d=0;d<8;d++){var e=25,f=250+4*e*Math.sin(d*Math.PI/4),g=250+4*e*Math.cos(d*Math.PI/4),h=c.addChild(new CMP.DisplayObject({radius:e,alpha:1/8*d,backgroundColor:"#000",x:f,y:g}));this.circles.push(h)}this._tickHandler=this._tickHandler.bind(this),createjs.Ticker.addEventListener("tick",this._tickHandler),this.timer=0},CMP.Overlay.prototype={_tickHandler:function(a){for(var b=a.delta,c=this.circles[0],d=c.alpha+b/800,e=c.alpha=d<=1?d:0,f=0;f<this.circles.length;f++)this.circles[f].alpha=e,e=(e+1/8)%1},blockInput:function(){},onRemoval:function(){createjs.Ticker.removeEventListener("tick",this._tickHandler)}},extend("CMP.Overlay","CMP.DisplayObjectContainer"),CMP.Partner={GetURL:function(){},CTA:function(a){return!!this.Open(a)&&(CMP.Log(CMP.Log.NOTICE,"Click registered with window"),!0)},Open:function(a){return!!CMP.openUsingWindow(a)&&(CMP.Log(CMP.Log.NOTICE,"Opened URL using window"),!0)},Finished:function(){return!1},Onload:function(){window.addEventListener("orientationchange",CMP.App._onResize,!1),window.addEventListener("resize",CMP.App._onResize,!1),CMP.Analytics.OnLoad(),CMP.App._onResize()},Resize:function(){var a=void 0,b=void 0;return window.innerWidth&&window.innerHeight?(a=window.innerWidth,b=window.innerHeight):"undefined"!=typeof screen?screen.availWidth&&screen.availHeight?(a=screen.availWidth,b=screen.availHeight):screen.width&&screen.height&&(a=screen.width,b=screen.height):(a=window.innerWidth,b=window.innerHeight),{w:a,h:b}}},CMP.Analytics={InitializeLogging:function(a){CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: Initializing Logging..."),CMP.Listen("PreMouseClick",this.HandlePreMouseClick.bind(this)),this.initEndpoint(),this.initPlayableName(),this.initSessionID(),this.initPartner(),CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: Initialized.")},HandlePreMouseClick:function(a){var b=a.data.target;if(b){var c=a.data.pointerData,d=b.analyticsName?b.analyticsName:b._globalName;this.OnButtonClick(d,c.x,c.y)}},initEndpoint:function(a){this.endpointURL="https://cmp-staging.herokuapp.com/analyticsEndpoint"},initPlayableName:function(a){var b=void 0!==AppConfig.CAMPAIGN&&""!=AppConfig.CAMPAIGN,c=void 0!==AppConfig.CREATIVE_NAME&&""!=AppConfig.CREATIVE_NAME,d=void 0===AppConfig.localization?"en":AppConfig.localization;this.playableName="",b&&c?this.playableName+=AppConfig.CAMPAIGN+"___"+AppConfig.CREATIVE_NAME:b&&!c?this.playableName+=AppConfig.CAMPAIGN:AppConfig.TITLE&&(this.playableName+=AppConfig.TITLE),this.playableName+="___"+d,CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: Playable name is",this.playableName)},initSessionID:function(a){this.sessionID=this.generateUUID()},initPartner:function(a){CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: noop initPartner")},BuildJSON:function(a){var b="Unknown Device";navigator.userAgent&&(b=navigator.userAgent.split("(")[1]);var c=navigator.userAgent,d=navigator.appVersion,e="-",f=e,g=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Chrome OS",r:/CrOS/},{s:"Linux",r:/(Linux|X11(?!.*CrOS))/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(Mac OS|MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var h in g){var i=g[h];if(i.r.test(c)){f=i.s;break}}var j=e;switch(/Windows/.test(f)&&(j=/Windows (.*)/.exec(f)[1],f="Windows"),f){case"Mac OS":case"Mac OS X":case"Android":j=/(?:Android|Mac OS|Mac OS X|MacPPC|MacIntel|Mac_PowerPC|Macintosh) ([\.\_\d]+)/.exec(c)[1];break;case"iOS":j=/OS (\d+)_(\d+)_?(\d+)?/.exec(d),j=j[1]+"."+j[2]+"."+(0|j[3])}return{event_type:"unknown_event",event_extra:{},session_id:this.sessionID,timestamp:(new Date).getTime(),deviceModel:b,os_ver:j,os:f,locale:navigator.language,country:"US",placement:this.getPlacement(),app_id:this.getAppID(),app_name:"test app",screen_width:this.getScreenWidth(),screen_height:this.getScreenHeight(),playable_name:this.playableName,is_implicit:!1,ad_id:this.getAdID()}},getPlacement:function(){return"unknown"},getAppID:function(){return-1},getAdID:function(){return-1},getScreenWidth:function(){return CMP.App.stage.width},getScreenHeight:function(){return CMP.App.stage.height},generateUUID:function(){var a=(new Date).getTime(),b=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var d=16*Math.random();return a>0?(d=(a+d)%16|0,a=Math.floor(a/16)):(d=(b+d)%16|0,b=Math.floor(b/16)),("x"===c?d:3&d|8).toString(16)})},PostToServer:function(a){var b="X-M-L-H-t-t-p-R-e-q-u-e-s-t",c=new(window[b.split("-").join("")]);c.open("POST",this.endpointURL,!0),a.event_extra&&(a.event_extra=JSON.stringify(a.event_extra));var d="";for(var e in a){d+="&"+e+"="+a[e]}c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.send(d)},SetupUnloadHook:function(a){CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: Unload Hook Set."),window.addEventListener("beforeunload",function(a){CMP.Analytics.OnUnloadHook(a)})},OnUnloadHook:function(a){CMP.Analytics.OnExit()},SetupFirstTap:function(a){CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: First Tap Listener Set."),this.OnFirstTap=this.OnFirstTap.bind(this),this.firstTapListener=CMP.App.stage.addEventListener("stagemousedown",this.OnFirstTap)},OnFirstTap:function(a){CMP.App.stage.removeEventListener("stagemousedown",this.OnFirstTap),CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: noop OnFirstTap")},SetupHeartbeat:function(a){CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: Heartbeat Set."),this.heartbeats=0,CMP.PerformAction({action:this.OnHeartbeat.bind(this),delay:5,repeat:!0})},OnHeartbeat:function(a){this.heartbeats+=1,CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: DoHeartbeat, beat ",this.heartbeats)},OnLoad:function(a){this.SetupUnloadHook(),this.SetupHeartbeat(),this.SetupFirstTap(),CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: noop !OnLoad")},OnButtonClick:function(a,b,c){CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: noop OnButtonClick on "+a,b,c)},OnCTA:function(a){CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: noop OnCTA")},OnExit:function(){CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: noop OnExit")},Progress:function(a){CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: noop Progress")},Finished:function(a){CMP.Log(CMP.Log.EXTRA,"CMP.Analytics: noop Finished")}};