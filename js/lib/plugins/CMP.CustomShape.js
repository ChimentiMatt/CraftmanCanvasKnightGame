CMP.CustomShape=function(a){this.construct(a)},CMP.CustomShape.prototype={defineSetters:function(){this.defineWithSetCallback("drawCommands",this.updateCommands.bind(this)),this.images=new Map},updateCommands:function(){this._updateGraphics()},processCommands:function(a,b){var c=!1,d=!1,e=!1;if(a&&b)for(var f=0;f<this.drawCommands.length;f++){var g=this.drawCommands[f],h=g.x,i=g.y,j=g.texture,k=g.rotation?g.rotation:0,l=g.scale?g.scale:1,m=g.bgColor?g.bgColor:this.backgroundColor,n=g.thickness?g.thickness:4,o=g.caps?g.caps:"round",p=g.joints?g.joints:"round",q=g.dashArray?g.dashArray:[20,10],r=g.dashOffset?g.dashOffset:0;Math.PI;switch(g.cornerRadius&&(g.command="rr"),j&&"string"==typeof j&&(this.images.has(j)||this.images.set(j,CMP.App.getImage(j)),j=this.images.get(j)),g.command){case"bf":this.graphics.beginFill(m),e=!0;break;case"ef":c=!1,e=!1,this.graphics.endFill();break;case"sd":this.graphics.sd(q,r);break;case"bs":c=!1,d=!0,this.graphics.beginStroke(m).ss(n,o,p);break;case"es":c=!1,d=!1,this.graphics.endStroke();break;case"close":this.graphics.closePath(),d=!1,e=!1;break;case"mt":this.graphics.moveTo(h,i),c=!0;break;case"rl":this.graphics.closePath();var s=g.x0,t=g.y0,u=g.x1,v=g.y1,w=g.xOffset?g.xOffset:0,x=g.yOffset?g.yOffset:0,y=Math.atan2(v-t,u-s),z=y+Math.PI/2,A=Math.cos(y),B=Math.sin(y),C=y*(180/Math.PI),D=j.height,E=g.repeat?g.repeat:"repeat",F=new createjs.Matrix2D,G=g.anchor?g.anchor:"center";if("edge-top"==G||"edge-bottom"==G||"edge"==G){var H=Math.sqrt((u-s)*(u-s)+(v-t)*(v-t));"edge-top"==G?x+=D/2+H/2:x-=D/2+H/2}x+=D/2,w+=n/2;var I=(s+u)/2+x*A-w*B,J=(t+v)/2+x*B+w*A,K=n/j.width;F.appendTransform(I,J,K,K,0),F.appendTransform(0,0,1,1,C+90),this.bitmapFillPatternObj=this.graphics.beginBitmapFill(j,E,F);var L=Math.cos(z),M=Math.sin(z),N=s-n/2*L,O=s+n/2*L,P=t-n/2*M,Q=t+n/2*M,R=u-n/2*L,S=u+n/2*L,T=v-n/2*M,U=v+n/2*M;this.graphics.moveTo(N,P),this.graphics.lineTo(O,Q),this.graphics.lineTo(S,U),this.graphics.lineTo(R,T),this.graphics.closePath(),d=!1,e=!1;break;case"l":var s=g.x0,t=g.y0,u=void 0!==g.x1?g.x1:g.x,v=void 0!==g.y1?g.y1:g.y;c||(this.graphics.moveTo(s,t),c=!0),d||(this.graphics.beginStroke(m).ss(n,o,p),d=!0),this.graphics.lineTo(u,v);break;case"ps":var V=Math.abs(g.radius?g.radius:g.r?g.r:50),W=g.sides?Math.abs(g.sides):5,X=g.pointSize?Math.abs(g.pointSize):.5;k-=90,e||this.graphics.beginFill(m),this.graphics.dp(h,i,V,W,X,k);break;case"r":var Y=g.width?g.width:g.w?g.w:g.wh?g.wh:50,Z=g.height?g.height:g.h?g.h:g.wh?g.wh:50;e||this.graphics.beginFill(m),this.graphics.drawRect(-Y/2+h,-Z/2+i,Y*l,Z*l);break;case"rr":var Y=g.width?g.width:g.w?g.w:g.wh?g.wh:50,Z=g.height?g.height:g.h?g.h:g.wh?g.wh:50,$=g.cornerRadius;e||this.graphics.beginFill(m),this.graphics.drawRoundRect(-Y/2+h,-Z/2+i,Y,Z,$);break;case"c":var V=Math.abs(g.radius?g.radius:g.r?g.r:50);e||this.graphics.beginFill(m),this.graphics.drawCircle(h,i,V)}}},_updateGraphics:function(){this.graphics.clear(),this.processCommands(this.drawCommands,!0)}},extend("CMP.CustomShape","CMP.DisplayObject");